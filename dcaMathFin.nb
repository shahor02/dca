(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    158808,       4448]
NotebookOptionsPosition[    149317,       4130]
NotebookOutlinePosition[    149655,       4145]
CellTagsIndexPosition[    149612,       4142]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7673538023636503`*^9, 3.7673538023685417`*^9}}],

Cell[CellGroupData[{

Cell["\<\
We minimize the sum of weighted residuals between 2 tracks posiotion in their \
local frames and their point of the common approach (also rotated to their \
respective local frames) wrt track running parameters X
Since the problem is non-linear, we do this using Newton-Rapson method, so \
the goal is to calculate 1st and 2nd direvitives of chi2 vs tracks parameters \
X.\
\>", "Section",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
  3.767934412119769*^9, 3.767934414814303*^9}, {3.767934937197554*^9, 
  3.767934950739828*^9}, {3.767945776799275*^9, 3.767945852360292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chi2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dy0", "^", "2"}], "*", "syy0"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"dz0", "^", "2"}], "*", "szz0"}], " ", "+", " ", 
       RowBox[{"2", " ", "dy0", "*", "dz0", "*", "syz0"}]}], ")"}]}], " ", 
    "+", " ", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dy1", "^", "2"}], "*", "syy1"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"dz1", "^", "2"}], "*", "szz1"}], " ", "+", " ", 
       RowBox[{"2", " ", "dy1", "*", "dz1", "*", "syz1"}]}], ")"}]}], "+", 
    " ", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dx0", "^", "2"}], "*", "sxx0"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"dx1", "^", "2"}], "*", "sxx1"}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.767350345927499*^9, 3.767350347307805*^9}, {
  3.7673504570949802`*^9, 3.767350457743685*^9}, {3.7679358505933247`*^9, 
  3.7679358815081987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "axx", ",", "axy", ",", "axz", ",", "ayy", ",", "ayz", ",", "azz", ",", 
      "cosA0", ",", "cosA1", ",", "sinA0", ",", "sinA1", ",", "DET", ",", " ",
       "x0", ",", "x1", ",", " ", "sxx0", ",", "sxx1", ",", "syy0", ",", 
      "syy1", ",", "szz0", ",", "szz1", ",", "syz0", ",", "syz1"}], "}"}], 
    ",", "Constant"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7675351086955357`*^9, 3.7675351578856583`*^9}, {
   3.767535218835555*^9, 3.767535219536487*^9}, 3.767535269298992*^9, {
   3.767535377306319*^9, 3.7675354208927717`*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[CellGroupData[{

Cell["\<\
local residuals definition // x0,y0(x0),z0(x0) is the track local posiotion \
in its frame rotated wrt lab by an angle A0, idem for 2nd track //\
\>", "Subsection",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
  3.767934412119769*^9, 3.767934414814303*^9}, {3.767934488174569*^9, 
  3.76793458949286*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DX0", " ", "=", " ", 
   RowBox[{"x0", " ", "-", " ", "Xl0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DY0", " ", "=", " ", 
   RowBox[{"y0", " ", "-", " ", "Yl0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DZ0", " ", "=", " ", 
   RowBox[{"z0", " ", "-", " ", "Zl0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DX1", " ", "=", " ", 
   RowBox[{"x1", " ", "-", " ", "Xl1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DY1", " ", "=", " ", 
   RowBox[{"y1", " ", "-", " ", "Yl1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DZ1", " ", "=", " ", 
   RowBox[{"z1", " ", "-", " ", "Zl1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767938459284944*^9, 3.767938493677835*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RuleD0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dx0", "\[Rule]", "DX0"}], ",", 
     RowBox[{"dx1", "\[Rule]", "DX1"}], ",", " ", 
     RowBox[{"dy0", "\[Rule]", "DY0"}], ",", " ", 
     RowBox[{"dy1", "\[Rule]", "DY1"}], ",", " ", 
     RowBox[{"dz0", "\[Rule]", "DZ0"}], ",", " ", 
     RowBox[{"dz1", "\[Rule]", "DZ1"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.767350576759056*^9, 3.767350620354697*^9}, {
  3.7673528825519323`*^9, 3.767352883724103*^9}, {3.767353339824153*^9, 
  3.76735335704979*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
PCA point (VX,VY,VZ) rotated to tracks respective frames\
\>", "Subsection",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
   3.767934412119769*^9, 3.767934414814303*^9}, {3.767934488174569*^9, 
   3.76793458949286*^9}, {3.7679346512317142`*^9, 3.767934678348199*^9}, 
   3.767937040172741*^9, {3.767937096382841*^9, 3.767937109354169*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xl0", " ", "=", " ", 
   RowBox[{
    RowBox[{"VX", "*", "cosA0"}], " ", "+", " ", 
    RowBox[{"VY", "*", "sinA0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yl0", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "VX"}], "*", "sinA0"}], " ", "+", " ", 
    RowBox[{"VY", "*", "cosA0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zl0", " ", "=", " ", "VZ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xl1", " ", "=", " ", 
   RowBox[{
    RowBox[{"VX", "*", "cosA1"}], " ", "+", " ", 
    RowBox[{"VY", "*", "sinA1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yl1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "VX"}], "*", "sinA1"}], " ", "+", " ", 
    RowBox[{"VY", "*", "cosA1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Zl1", " ", "=", " ", "VZ"}], ";"}]}], "Input",
 CellChangeTimes->{{3.74444842584584*^9, 3.744448471704056*^9}, {
  3.7445469189959183`*^9, 3.744546971994042*^9}, {3.767937042164565*^9, 
  3.767937045958709*^9}, {3.7679370968010607`*^9, 3.767937109498931*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
1) For any given 2 tracks positions the PCA point can be represented via \
linear combination of local track coordinates by minimizing the same chi2 wrt \
PCA coordinates  VX,VY,VZ:\
\>", "Section",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
   3.767934412119769*^9, 3.767934414814303*^9}, {3.767934867601762*^9, 
   3.767934999762636*^9}, 3.767937048048403*^9, {3.7679370975742283`*^9, 
   3.767937109584992*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dchiVX", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"chi2", " ", "//.", " ", "RuleD0"}], ",", "VX"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dchiVY", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"chi2", "//.", " ", "RuleD0"}], ",", "VY"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dchiVZ", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"chi2", "//.", " ", "RuleD0"}], ",", "VZ"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7444485980165043`*^9, 3.7444486865140123`*^9}, {
  3.76793705079935*^9, 3.767937051756377*^9}, {3.7679370977433653`*^9, 
  3.767937109807351*^9}, {3.767938542602874*^9, 3.767938570177402*^9}}],

Cell[CellGroupData[{

Cell["\<\
leading to solution of matrix equation\
\>", "Subsection",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
  3.767934412119769*^9, 3.767934414814303*^9}, {3.767934488174569*^9, 
  3.76793458949286*^9}, {3.7679346512317142`*^9, 3.767934678348199*^9}, {
  3.7679351110574493`*^9, 3.767935121618577*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matA", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"axx", ",", "axy", ",", "axz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"axy", ",", "ayy", ",", "ayz"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"axz", ",", "ayz", ",", "azz"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.744449276156803*^9, 3.7444493266652937`*^9}, {
  3.7444495210717697`*^9, 3.744449528464508*^9}, {3.7445480212317257`*^9, 
  3.744548022950939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vecB", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"bx", ",", "by", ",", "bz"}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ruleLHS", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"axx", "\[Rule]", 
      RowBox[{"D", "[", 
       RowBox[{"dchiVX", ",", "VX"}], "]"}]}], ",", " ", 
     RowBox[{"axy", "\[Rule]", 
      RowBox[{"D", "[", 
       RowBox[{"dchiVX", ",", "VY"}], "]"}]}], ",", 
     RowBox[{"axz", "\[Rule]", 
      RowBox[{"D", "[", 
       RowBox[{"dchiVX", ",", "VZ"}], "]"}]}], ",", 
     RowBox[{"ayy", "\[Rule]", 
      RowBox[{"D", "[", 
       RowBox[{"dchiVY", ",", "VY"}], "]"}]}], ",", " ", 
     RowBox[{"ayz", "\[Rule]", 
      RowBox[{"D", "[", 
       RowBox[{"dchiVY", ",", "VZ"}], "]"}]}], ",", 
     RowBox[{"azz", "\[Rule]", 
      RowBox[{"D", "[", 
       RowBox[{"dchiVZ", ",", "VZ"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleRHS", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"bx", "\[Rule]", 
       RowBox[{"-", "dchiVX"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"VX", "\[Rule]", "0"}], ",", 
        RowBox[{"VY", "\[Rule]", "0"}], ",", 
        RowBox[{"VZ", "\[Rule]", "0"}]}], "}"}]}], ",", " ", 
     RowBox[{
      RowBox[{"by", "\[Rule]", 
       RowBox[{"-", "dchiVY"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"VX", "\[Rule]", "0"}], ",", 
        RowBox[{"VY", "\[Rule]", "0"}], ",", 
        RowBox[{"VZ", "\[Rule]", "0"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"bz", "\[Rule]", 
       RowBox[{"-", "dchiVZ"}]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"VX", "\[Rule]", "0"}], ",", 
        RowBox[{"VY", "\[Rule]", "0"}], ",", 
        RowBox[{"VZ", "\[Rule]", "0"}]}], "}"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ruleCS", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cosA0", "\[Rule]", 
      RowBox[{"Cos", "[", "A0", "]"}]}], ",", " ", 
     RowBox[{"sinA0", "\[Rule]", 
      RowBox[{"Sin", "[", "A0", "]"}]}], ",", " ", 
     RowBox[{"cosA1", "\[Rule]", 
      RowBox[{"Cos", "[", "A1", "]"}]}], ",", " ", 
     RowBox[{"sinA1", "\[Rule]", 
      RowBox[{"Sin", "[", "A1", "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767533972274684*^9, 3.76753401204734*^9}, 
   3.767594185128834*^9, 3.767594245498866*^9, 3.767936115174203*^9, 
   3.767936201174337*^9, {3.7679366609002*^9, 3.767936662200028*^9}, {
   3.767937056532834*^9, 3.767937067131688*^9}, {3.767937097886444*^9, 
   3.767937109219859*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["elements of the matrix:", "Subsection",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
   3.767934412119769*^9, 3.767934414814303*^9}, {3.767934488174569*^9, 
   3.76793458949286*^9}, {3.7679346512317142`*^9, 3.767934678348199*^9}, {
   3.7679351110574493`*^9, 3.767935121618577*^9}, {3.7679362927416487`*^9, 
   3.767936309907658*^9}, 3.767962442283222*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ruleM", " ", "=", " ", 
  RowBox[{"Union", "[", 
   RowBox[{"ruleLHS", ",", " ", "ruleRHS"}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.744452255337759*^9, 3.744452461336084*^9}, 
   3.767533984742695*^9, {3.767534019153613*^9, 3.767534042259883*^9}, {
   3.7675340788024807`*^9, 3.767534094920169*^9}, {3.767534177535281*^9, 
   3.767534209206129*^9}, {3.767592267384427*^9, 3.767592318896749*^9}, 
   3.7675941856675673`*^9, 3.767594249111229*^9, {3.767936205309555*^9, 
   3.767936221018703*^9}, 3.7679362629150867`*^9, {3.767936638582799*^9, 
   3.767936640286519*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"axx", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["cosA0", "2"], " ", "sxx0"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["cosA1", "2"], " ", "sxx1"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["sinA0", "2"], " ", "syy0"}], "+", 
     RowBox[{
      SuperscriptBox["sinA1", "2"], " ", "syy1"}]}]}], ",", 
   RowBox[{"axy", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "cosA0", " ", "sinA0", " ", "sxx0"}], "+", 
        RowBox[{"2", " ", "cosA1", " ", "sinA1", " ", "sxx1"}]}], ")"}]}], 
     "-", 
     RowBox[{"cosA0", " ", "sinA0", " ", "syy0"}], "-", 
     RowBox[{"cosA1", " ", "sinA1", " ", "syy1"}]}]}], ",", 
   RowBox[{"axz", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sinA0"}], " ", "syz0"}], "-", 
     RowBox[{"sinA1", " ", "syz1"}]}]}], ",", 
   RowBox[{"ayy", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["sinA0", "2"], " ", "sxx0"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["sinA1", "2"], " ", "sxx1"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["cosA0", "2"], " ", "syy0"}], "+", 
     RowBox[{
      SuperscriptBox["cosA1", "2"], " ", "syy1"}]}]}], ",", 
   RowBox[{"ayz", "\[Rule]", 
    RowBox[{
     RowBox[{"cosA0", " ", "syz0"}], "+", 
     RowBox[{"cosA1", " ", "syz1"}]}]}], ",", 
   RowBox[{"azz", "\[Rule]", 
    RowBox[{"szz0", "+", "szz1"}]}], ",", 
   RowBox[{"bx", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "cosA0", " ", "sxx0", " ", "x0"}], "+", 
        RowBox[{"2", " ", "cosA1", " ", "sxx1", " ", "x1"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "sinA0", " ", "syy0", " ", "y0"}], "-", 
        RowBox[{"2", " ", "sinA0", " ", "syz0", " ", "z0"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "sinA1", " ", "syy1", " ", "y1"}], "-", 
        RowBox[{"2", " ", "sinA1", " ", "syz1", " ", "z1"}]}], ")"}]}]}]}], 
   ",", 
   RowBox[{"by", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "sinA0", " ", "sxx0", " ", "x0"}], "+", 
        RowBox[{"2", " ", "sinA1", " ", "sxx1", " ", "x1"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "cosA0", " ", "syy0", " ", "y0"}], "+", 
        RowBox[{"2", " ", "cosA0", " ", "syz0", " ", "z0"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "cosA1", " ", "syy1", " ", "y1"}], "+", 
        RowBox[{"2", " ", "cosA1", " ", "syz1", " ", "z1"}]}], ")"}]}]}]}], 
   ",", 
   RowBox[{"bz", "\[Rule]", 
    RowBox[{
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "syz0", " ", "y0"}], "+", 
        RowBox[{"2", " ", "szz0", " ", "z0"}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "syz1", " ", "y1"}], "+", 
        RowBox[{"2", " ", "szz1", " ", "z1"}]}], ")"}]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.767936263826408*^9, 3.7679367012664433`*^9, 
  3.767937208880858*^9, 3.767938609078123*^9, 3.7679410132786007`*^9, 
  3.7679412498849363`*^9, 3.767941894694105*^9, 3.767946821829248*^9, 
  3.767946978751997*^9, 3.767948443770431*^9, 3.767960865288219*^9, 
  3.767960928226283*^9, 3.7679609653468733`*^9, 3.767962155496505*^9, 
  3.767962419891732*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{"matA", " ", "/.", " ", "ruleM"}], " ", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.744626003702506*^9, 3.744626024432132*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["cosA0", "2"], " ", "sxx0"}], "+", 
       RowBox[{
        SuperscriptBox["cosA1", "2"], " ", "sxx1"}], "+", 
       RowBox[{
        SuperscriptBox["sinA0", "2"], " ", "syy0"}], "+", 
       RowBox[{
        SuperscriptBox["sinA1", "2"], " ", "syy1"}]}], 
      RowBox[{
       RowBox[{"cosA0", " ", "sinA0", " ", 
        RowBox[{"(", 
         RowBox[{"sxx0", "-", "syy0"}], ")"}]}], "+", 
       RowBox[{"cosA1", " ", "sinA1", " ", 
        RowBox[{"(", 
         RowBox[{"sxx1", "-", "syy1"}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "sinA0"}], " ", "syz0"}], "-", 
       RowBox[{"sinA1", " ", "syz1"}]}]},
     {
      RowBox[{
       RowBox[{"cosA0", " ", "sinA0", " ", 
        RowBox[{"(", 
         RowBox[{"sxx0", "-", "syy0"}], ")"}]}], "+", 
       RowBox[{"cosA1", " ", "sinA1", " ", 
        RowBox[{"(", 
         RowBox[{"sxx1", "-", "syy1"}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["sinA0", "2"], " ", "sxx0"}], "+", 
       RowBox[{
        SuperscriptBox["sinA1", "2"], " ", "sxx1"}], "+", 
       RowBox[{
        SuperscriptBox["cosA0", "2"], " ", "syy0"}], "+", 
       RowBox[{
        SuperscriptBox["cosA1", "2"], " ", "syy1"}]}], 
      RowBox[{
       RowBox[{"cosA0", " ", "syz0"}], "+", 
       RowBox[{"cosA1", " ", "syz1"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "sinA0"}], " ", "syz0"}], "-", 
       RowBox[{"sinA1", " ", "syz1"}]}], 
      RowBox[{
       RowBox[{"cosA0", " ", "syz0"}], "+", 
       RowBox[{"cosA1", " ", "syz1"}]}], 
      RowBox[{"szz0", "+", "szz1"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.76793595525173*^9, 3.767937212715622*^9, 
  3.767938609474448*^9, 3.7679410134130707`*^9, 3.7679412501276484`*^9, 
  3.767941895157289*^9, 3.7679468223493757`*^9, 3.7679469790518017`*^9, 
  3.7679484441967688`*^9, 3.767960865472046*^9, 3.767960928596167*^9, 
  3.7679609657086973`*^9, 3.767962155814003*^9, 3.7679624202475243`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{"vecB", " ", "/.", " ", "ruleM"}], " ", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.744626045386381*^9, 3.744626046519319*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"cosA0", " ", "sxx0", " ", "x0"}], "+", 
        RowBox[{"cosA1", " ", "sxx1", " ", "x1"}], "-", 
        RowBox[{"sinA0", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"syy0", " ", "y0"}], "+", 
           RowBox[{"syz0", " ", "z0"}]}], ")"}]}], "-", 
        RowBox[{"sinA1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"syy1", " ", "y1"}], "+", 
           RowBox[{"syz1", " ", "z1"}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{"sinA0", " ", "sxx0", " ", "x0"}], "+", 
        RowBox[{"sinA1", " ", "sxx1", " ", "x1"}], "+", 
        RowBox[{"cosA0", " ", "syy0", " ", "y0"}], "+", 
        RowBox[{"cosA1", " ", "syy1", " ", "y1"}], "+", 
        RowBox[{"cosA0", " ", "syz0", " ", "z0"}], "+", 
        RowBox[{"cosA1", " ", "syz1", " ", "z1"}]}]},
      {
       RowBox[{
        RowBox[{"syz0", " ", "y0"}], "+", 
        RowBox[{"syz1", " ", "y1"}], "+", 
        RowBox[{"szz0", " ", "z0"}], "+", 
        RowBox[{"szz1", " ", "z1"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7679359589568787`*^9, 3.767937214683913*^9, 
  3.767938613331482*^9, 3.767941013585643*^9, 3.76794125103487*^9, 
  3.767941897059873*^9, 3.767946824211341*^9, 3.767946979161537*^9, 
  3.7679484446432056`*^9, 3.7679608656635447`*^9, 3.767960929249845*^9, 
  3.767960966282538*^9, 3.7679621561152067`*^9, 3.76796242103376*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", " ", "=", " ", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{"matA", ",", "vecB"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.744449369011677*^9, 3.744449401400216*^9}, {
  3.7444501062744827`*^9, 3.744450108469195*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["ayz", "2"], " ", "bx"}], "-", 
     RowBox[{"ayy", " ", "azz", " ", "bx"}], "-", 
     RowBox[{"axz", " ", "ayz", " ", "by"}], "+", 
     RowBox[{"axy", " ", "azz", " ", "by"}], "+", 
     RowBox[{"axz", " ", "ayy", " ", "bz"}], "-", 
     RowBox[{"axy", " ", "ayz", " ", "bz"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["axz", "2"], " ", "ayy"}], "-", 
     RowBox[{"2", " ", "axy", " ", "axz", " ", "ayz"}], "+", 
     RowBox[{"axx", " ", 
      SuperscriptBox["ayz", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["axy", "2"], " ", "azz"}], "-", 
     RowBox[{"axx", " ", "ayy", " ", "azz"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "axz"}], " ", "ayz", " ", "bx"}], "+", 
     RowBox[{"axy", " ", "azz", " ", "bx"}], "+", 
     RowBox[{
      SuperscriptBox["axz", "2"], " ", "by"}], "-", 
     RowBox[{"axx", " ", "azz", " ", "by"}], "-", 
     RowBox[{"axy", " ", "axz", " ", "bz"}], "+", 
     RowBox[{"axx", " ", "ayz", " ", "bz"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["axz", "2"], " ", "ayy"}], "-", 
     RowBox[{"2", " ", "axy", " ", "axz", " ", "ayz"}], "+", 
     RowBox[{"axx", " ", 
      SuperscriptBox["ayz", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["axy", "2"], " ", "azz"}], "-", 
     RowBox[{"axx", " ", "ayy", " ", "azz"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "axz"}], " ", "ayy", " ", "bx"}], "+", 
     RowBox[{"axy", " ", "ayz", " ", "bx"}], "+", 
     RowBox[{"axy", " ", "axz", " ", "by"}], "-", 
     RowBox[{"axx", " ", "ayz", " ", "by"}], "-", 
     RowBox[{
      SuperscriptBox["axy", "2"], " ", "bz"}], "+", 
     RowBox[{"axx", " ", "ayy", " ", "bz"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["axz", "2"]}], " ", "ayy"}], "+", 
     RowBox[{"2", " ", "axy", " ", "axz", " ", "ayz"}], "-", 
     RowBox[{"axx", " ", 
      SuperscriptBox["ayz", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["axy", "2"], " ", "azz"}], "+", 
     RowBox[{"axx", " ", "ayy", " ", "azz"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.7679359603441896`*^9, 3.7679372156965218`*^9, 
  3.767938614758251*^9, 3.767941014042686*^9, 3.767941251321031*^9, 
  3.7679418976854963`*^9, 3.7679468252667027`*^9, 3.767946979329287*^9, 
  3.7679484453923063`*^9, 3.7679608657618837`*^9, 3.7679609295208607`*^9, 
  3.767960966547812*^9, 3.767962156630144*^9, 3.7679624213751583`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
We want to represent the solution (PCA coordinates) as a linear sum of points \
coordinates, i.e.
  VX = x0 XX0 + y0 XY0 + z0 XZ0 + x1 XX1 + y1 XY1 + z1 XZ1 etc.
  Note: the coefficients XX0... do not depend on tracks positions but do \
depend on their frames angles and on track errors at evaluation points\
\>", "Subsubsection",
 CellChangeTimes->{{3.7675349938916388`*^9, 3.7675350760276127`*^9}, {
   3.7679352800862427`*^9, 3.767935287212122*^9}, 3.767937074229012*^9, {
   3.767938735442761*^9, 3.767938812887368*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ruleDET", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["axz", "2"], " ", "ayy"}], "-", 
       RowBox[{"2", " ", "axy", " ", "axz", " ", "ayz"}], "+", 
       RowBox[{"axx", " ", 
        SuperscriptBox["ayz", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["axy", "2"], " ", "azz"}], "-", 
       RowBox[{"axx", " ", "ayy", " ", "azz"}]}], " ", "\[Rule]", " ", 
      RowBox[{"-", "DET"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["axz", "2"]}], " ", "ayy"}], "+", 
       RowBox[{"2", " ", "axy", " ", "axz", " ", "ayz"}], "-", 
       RowBox[{"axx", " ", 
        SuperscriptBox["ayz", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["axy", "2"], " ", "azz"}], "+", 
       RowBox[{"axx", " ", "ayy", " ", "azz"}]}], "\[Rule]", " ", "DET"}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.767936756497818*^9, 3.767936773904961*^9}},
 FontColor->RGBColor[1, 0, 0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solD", " ", "=", " ", 
   RowBox[{"sol", " ", "//.", " ", "ruleDET"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.767534907425391*^9, 3.767534955604809*^9}, 
   3.767534986670128*^9, {3.767535261242181*^9, 3.767535263653775*^9}, {
   3.767593311627087*^9, 3.767593315643589*^9}, 3.767935418337049*^9, {
   3.767936769344975*^9, 3.767936785295377*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sVX", " ", "=", " ", 
   RowBox[{"solD", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sVY", " ", "=", " ", 
   RowBox[{"solD", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sVZ", " ", "=", " ", 
   RowBox[{"solD", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.767534876346643*^9, 3.767534884932931*^9}, {
   3.76753518089921*^9, 3.767535214788638*^9}, 3.767590554572268*^9, {
   3.7675908105186043`*^9, 3.7675908334616413`*^9}, {3.767591333433547*^9, 
   3.767591339235393*^9}, {3.767935422331463*^9, 3.7679354231505404`*^9}}],

Cell["Note : for simplicity we omit the common DET divisor below", "Text",
 CellChangeTimes->{{3.767935667511437*^9, 3.767935686372308*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tXX0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVX", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], " ", ",", " ", "x0"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7675905917385187`*^9, 3.767590595094619*^9}, {
   3.767590669740809*^9, 3.767590707530301*^9}, {3.7675908675892677`*^9, 
   3.7675909275844193`*^9}, {3.767590961465246*^9, 3.767590964235243*^9}, {
   3.767594173535885*^9, 3.76759418673137*^9}, 3.767594217596779*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(Power(ayz,2)*cosA0*sxx0) + ayy*azz*cosA0*sxx0 + axz*ayz*sinA0*sxx0 - \
axy*azz*sinA0*sxx0\
\>", "Output",
 CellChangeTimes->{3.767935967973776*^9, 3.76793723158821*^9, 
  3.7679386227319736`*^9, 3.767941014174431*^9, 3.7679412523165703`*^9, 
  3.7679419009827957`*^9, 3.76794683487868*^9, 3.7679469796340113`*^9, 
  3.767948446274044*^9, 3.76796086608182*^9, 3.767960930165374*^9, 
  3.767960967354529*^9, 3.767962156911215*^9, 3.767962422456113*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tXY0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVX", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "y0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591006307384*^9, 3.767591014747595*^9}, {
   3.767594174323526*^9, 3.7675941872623158`*^9}, 3.767594314259658*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axz*ayz*cosA0*syy0 - axy*azz*cosA0*syy0 + Power(ayz,2)*sinA0*syy0 - \
ayy*azz*sinA0*syy0 - axz*ayy*syz0 + axy*ayz*syz0\
\>", "Output",
 CellChangeTimes->{3.7679359732301607`*^9, 3.767937235576479*^9, 
  3.7679386248101997`*^9, 3.767941014240768*^9, 3.76794125252175*^9, 
  3.767941902592277*^9, 3.767946836986155*^9, 3.767946979733109*^9, 
  3.7679484466917973`*^9, 3.767960866107229*^9, 3.76796093047038*^9, 
  3.767960967670896*^9, 3.767962157179924*^9, 3.7679624232260036`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tXZ0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVX", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "z0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591027613867*^9, 3.76759103322316*^9}, {
   3.767594174927558*^9, 3.767594187755699*^9}, 3.7675943149023533`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axz*ayz*cosA0*syz0 - axy*azz*cosA0*syz0 + Power(ayz,2)*sinA0*syz0 - \
ayy*azz*sinA0*syz0 - axz*ayy*szz0 + axy*ayz*szz0\
\>", "Output",
 CellChangeTimes->{3.767935976412116*^9, 3.7679372418227797`*^9, 
  3.767938629475272*^9, 3.767941014329732*^9, 3.7679412530664043`*^9, 
  3.767941904108551*^9, 3.7679468385235643`*^9, 3.76794697982277*^9, 
  3.7679484467079477`*^9, 3.767960866195806*^9, 3.767960930486218*^9, 
  3.767960967686343*^9, 3.767962157722361*^9, 3.767962423244665*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tXX1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVX", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "x1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591039492539*^9, 3.7675910460922203`*^9}, {
   3.767594175465248*^9, 3.7675941883991137`*^9}, 3.767594315493228*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(Power(ayz,2)*cosA1*sxx1) + ayy*azz*cosA1*sxx1 + axz*ayz*sinA1*sxx1 - \
axy*azz*sinA1*sxx1\
\>", "Output",
 CellChangeTimes->{3.767935981230379*^9, 3.767937248187985*^9, 
  3.76793863331448*^9, 3.7679410143471212`*^9, 3.767941253202408*^9, 
  3.7679419054924097`*^9, 3.767946840223282*^9, 3.767946979936015*^9, 
  3.767948447139099*^9, 3.76796086628397*^9, 3.767960930778611*^9, 
  3.767960968030827*^9, 3.7679621577414293`*^9, 3.7679624236747923`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tXY1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVX", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "y1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7675910525131083`*^9, 3.767591057770328*^9}, {
   3.767594175987339*^9, 3.7675941890361223`*^9}, 3.7675943161125793`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axz*ayz*cosA1*syy1 - axy*azz*cosA1*syy1 + Power(ayz,2)*sinA1*syy1 - \
ayy*azz*sinA1*syy1 - axz*ayy*syz1 + axy*ayz*syz1\
\>", "Output",
 CellChangeTimes->{3.767935985388342*^9, 3.767937252356743*^9, 
  3.767938637113604*^9, 3.767941014418365*^9, 3.767941253387761*^9, 
  3.767941906856269*^9, 3.767946841645462*^9, 3.767946979957841*^9, 
  3.767948447863208*^9, 3.7679608662986813`*^9, 3.767960930793951*^9, 
  3.767960968505274*^9, 3.767962158024289*^9, 3.76796242442093*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tXZ1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVX", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "z1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591064507258*^9, 3.767591070033517*^9}, {
   3.767591204061858*^9, 3.767591241881761*^9}, {3.767594176579156*^9, 
   3.767594189651259*^9}, 3.7675943167354927`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axz*ayz*cosA1*syz1 - axy*azz*cosA1*syz1 + Power(ayz,2)*sinA1*syz1 - \
ayy*azz*sinA1*syz1 - axz*ayy*szz1 + axy*ayz*szz1\
\>", "Output",
 CellChangeTimes->{3.767935989088056*^9, 3.767937256308572*^9, 
  3.76793864131927*^9, 3.767941014487026*^9, 3.767941253403213*^9, 
  3.767941908325881*^9, 3.767946843068191*^9, 3.767946980106612*^9, 
  3.767948447881235*^9, 3.767960866387096*^9, 3.767960931396904*^9, 
  3.767960968774884*^9, 3.7679621580433693`*^9, 3.767962424438364*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tYX0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVY", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "x0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7675905917385187`*^9, 3.767590595094619*^9}, {
   3.767590669740809*^9, 3.767590707530301*^9}, {3.7675908675892677`*^9, 
   3.7675909275844193`*^9}, {3.767590961465246*^9, 3.767590964235243*^9}, {
   3.76759130673682*^9, 3.767591330835744*^9}, {3.7675941771201477`*^9, 
   3.76759419027782*^9}, 3.767594317338709*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axz*ayz*cosA0*sxx0 - axy*azz*cosA0*sxx0 - Power(axz,2)*sinA0*sxx0 + \
axx*azz*sinA0*sxx0\
\>", "Output",
 CellChangeTimes->{3.767935992700354*^9, 3.7679372602763863`*^9, 
  3.767938646029318*^9, 3.767941014556383*^9, 3.7679412535473223`*^9, 
  3.767941909867367*^9, 3.767946844583696*^9, 3.767946980235107*^9, 
  3.76794844828494*^9, 3.767960866453114*^9, 3.767960931680575*^9, 
  3.7679609687884407`*^9, 3.767962158279841*^9, 3.767962424816843*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tYY0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVY", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "y0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591006307384*^9, 3.767591014747595*^9}, {
   3.7675913072670593`*^9, 3.767591331361621*^9}, {3.7675941777711678`*^9, 
   3.767594190904333*^9}, 3.767594317945013*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(Power(axz,2)*cosA0*syy0) + axx*azz*cosA0*syy0 - axz*ayz*sinA0*syy0 + \
axy*azz*sinA0*syy0 + axy*axz*syz0 - axx*ayz*syz0\
\>", "Output",
 CellChangeTimes->{3.76793599616889*^9, 3.767937265269721*^9, 
  3.767938650256344*^9, 3.767941014639551*^9, 3.7679412547074423`*^9, 
  3.767941911349538*^9, 3.767946846207473*^9, 3.7679469803305187`*^9, 
  3.767948449101087*^9, 3.767960866518856*^9, 3.767960931931978*^9, 
  3.767960969069396*^9, 3.767962158711228*^9, 3.767962425584695*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tYZ0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVY", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "z0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591027613867*^9, 3.76759103322316*^9}, {
   3.767591307744768*^9, 3.76759133171487*^9}, {3.767594178324131*^9, 
   3.767594191539782*^9}, 3.7675943185416117`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(Power(axz,2)*cosA0*syz0) + axx*azz*cosA0*syz0 - axz*ayz*sinA0*syz0 + \
axy*azz*sinA0*syz0 + axy*axz*szz0 - axx*ayz*szz0\
\>", "Output",
 CellChangeTimes->{3.767936000854788*^9, 3.76793726901932*^9, 
  3.767938653090654*^9, 3.767941015120356*^9, 3.767941255421513*^9, 
  3.767941912810391*^9, 3.767946847910411*^9, 3.767946980592148*^9, 
  3.767948449597694*^9, 3.767960866599478*^9, 3.7679609325331097`*^9, 
  3.767960969370805*^9, 3.767962158920528*^9, 3.767962425603628*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tYX1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVY", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "x1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591039492539*^9, 3.7675910460922203`*^9}, {
   3.767591308076111*^9, 3.767591332192045*^9}, {3.7675941789315166`*^9, 
   3.7675941921647253`*^9}, 3.767594319180357*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axz*ayz*cosA1*sxx1 - axy*azz*cosA1*sxx1 - Power(axz,2)*sinA1*sxx1 + \
axx*azz*sinA1*sxx1\
\>", "Output",
 CellChangeTimes->{3.767936005396666*^9, 3.76793727290088*^9, 
  3.767938655250585*^9, 3.767941015137897*^9, 3.767941255561968*^9, 
  3.767941914330845*^9, 3.767946849478221*^9, 3.7679469806115828`*^9, 
  3.767948450430694*^9, 3.7679608666707153`*^9, 3.7679609328384247`*^9, 
  3.767960969811246*^9, 3.76796215913669*^9, 3.767962426063916*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tYY1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVY", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "y1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7675910525131083`*^9, 3.767591057770328*^9}, {
   3.7675913116447783`*^9, 3.7675913325379744`*^9}, {3.767594179542597*^9, 
   3.767594192790443*^9}, 3.767594320010633*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(Power(axz,2)*cosA1*syy1) + axx*azz*cosA1*syy1 - axz*ayz*sinA1*syy1 + \
axy*azz*sinA1*syy1 + axy*axz*syz1 - axx*ayz*syz1\
\>", "Output",
 CellChangeTimes->{3.7679360099083014`*^9, 3.767937274186049*^9, 
  3.767938656416533*^9, 3.767941015207058*^9, 3.7679412557305307`*^9, 
  3.7679419157452307`*^9, 3.7679468509730186`*^9, 3.767946980713505*^9, 
  3.7679484508803663`*^9, 3.767960866685178*^9, 3.767960933129182*^9, 
  3.7679609701749372`*^9, 3.767962159342532*^9, 3.767962426432407*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tYZ1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVY", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "z1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591064507258*^9, 3.767591070033517*^9}, {
   3.767591204061858*^9, 3.767591241881761*^9}, {3.767591312805808*^9, 
   3.767591332870707*^9}, {3.767594180301155*^9, 3.767594193418068*^9}, 
   3.767594320719503*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(Power(axz,2)*cosA1*syz1) + axx*azz*cosA1*syz1 - axz*ayz*sinA1*syz1 + \
axy*azz*sinA1*syz1 + axy*axz*szz1 - axx*ayz*szz1\
\>", "Output",
 CellChangeTimes->{3.767936014646429*^9, 3.767937275583727*^9, 
  3.767938660138524*^9, 3.767941015280995*^9, 3.767941256441979*^9, 
  3.767941917389661*^9, 3.767946852746698*^9, 3.767946980815604*^9, 
  3.767948451626244*^9, 3.767960866752557*^9, 3.7679609337289867`*^9, 
  3.767960970835895*^9, 3.767962159767829*^9, 3.767962426829948*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tZX0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVZ", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "x0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7675905917385187`*^9, 3.767590595094619*^9}, {
   3.767590669740809*^9, 3.767590707530301*^9}, {3.7675908675892677`*^9, 
   3.7675909275844193`*^9}, {3.767590961465246*^9, 3.767590964235243*^9}, {
   3.76759130673682*^9, 3.767591330835744*^9}, 3.7675913739737864`*^9, 
   3.767591405023909*^9, {3.76759418105335*^9, 3.7675942007847443`*^9}},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(axz*ayy*cosA0*sxx0) + axy*ayz*cosA0*sxx0 + axy*axz*sinA0*sxx0 - \
axx*ayz*sinA0*sxx0\
\>", "Output",
 CellChangeTimes->{3.7679360192900677`*^9, 3.767937277487701*^9, 
  3.767938663150585*^9, 3.7679410153513947`*^9, 3.767941256459833*^9, 
  3.767941918890918*^9, 3.767946854347183*^9, 3.767946980833997*^9, 
  3.7679484516433496`*^9, 3.7679608668230352`*^9, 3.7679609340067596`*^9, 
  3.767960971158448*^9, 3.767962159785754*^9, 3.7679624268471613`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tZY0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVZ", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "y0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591006307384*^9, 3.767591014747595*^9}, {
   3.7675913072670593`*^9, 3.767591331361621*^9}, 3.767591374589164*^9, 
   3.7675914056776133`*^9, 3.7675941818093147`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axy*axz*cosA0*syy0 - axx*ayz*cosA0*syy0 + axz*ayy*sinA0*syy0 - \
axy*ayz*sinA0*syy0 - Power(axy,2)*syz0 + axx*ayy*syz0\
\>", "Output",
 CellChangeTimes->{3.767936024560141*^9, 3.767937278465249*^9, 
  3.767938666572101*^9, 3.767941015436569*^9, 3.7679412566085052`*^9, 
  3.767941920364496*^9, 3.767946855787467*^9, 3.767946980931584*^9, 
  3.767948452059664*^9, 3.767960866949821*^9, 3.767960934251419*^9, 
  3.767960971174233*^9, 3.7679621599801064`*^9, 3.767962427261557*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tZZ0", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVZ", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "z0"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591027613867*^9, 3.76759103322316*^9}, {
   3.767591307744768*^9, 3.76759133171487*^9}, 3.767591375014234*^9, 
   3.767591406123811*^9, 3.767594182618486*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axy*axz*cosA0*syz0 - axx*ayz*cosA0*syz0 + axz*ayy*sinA0*syz0 - \
axy*ayz*sinA0*syz0 - Power(axy,2)*szz0 + axx*ayy*szz0\
\>", "Output",
 CellChangeTimes->{3.7679360299054193`*^9, 3.767937279083077*^9, 
  3.76793867029956*^9, 3.767941015453817*^9, 3.767941256759296*^9, 
  3.767941921793659*^9, 3.767946857164253*^9, 3.767946981033669*^9, 
  3.767948452750386*^9, 3.767960867038102*^9, 3.7679609345591497`*^9, 
  3.7679609714918633`*^9, 3.767962160211068*^9, 3.7679624280031233`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tZX1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVZ", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "x1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591039492539*^9, 3.7675910460922203`*^9}, {
   3.767591308076111*^9, 3.767591332192045*^9}, 3.767591375360311*^9, 
   3.7675914065926847`*^9, 3.76759418323171*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
-(axz*ayy*cosA1*sxx1) + axy*ayz*cosA1*sxx1 + axy*axz*sinA1*sxx1 - \
axx*ayz*sinA1*sxx1\
\>", "Output",
 CellChangeTimes->{3.767936033746299*^9, 3.767937280420253*^9, 
  3.767938672065155*^9, 3.767941015524947*^9, 3.767941257375095*^9, 
  3.767941923294541*^9, 3.767946858691165*^9, 3.7679469811680727`*^9, 
  3.767948452767927*^9, 3.767960867135871*^9, 3.767960934896381*^9, 
  3.7679609719992113`*^9, 3.767962160227511*^9, 3.7679624280212183`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tZY1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVZ", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "y1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.7675910525131083`*^9, 3.767591057770328*^9}, {
   3.7675913116447783`*^9, 3.7675913325379744`*^9}, 3.76759137582036*^9, 
   3.767591407483123*^9, 3.767594183847541*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axy*axz*cosA1*syy1 - axx*ayz*cosA1*syy1 + axz*ayy*sinA1*syy1 - \
axy*ayz*sinA1*syy1 - Power(axy,2)*syz1 + axx*ayy*syz1\
\>", "Output",
 CellChangeTimes->{3.767936038068009*^9, 3.76793728412753*^9, 
  3.767938674498807*^9, 3.767941015586103*^9, 3.767941257393958*^9, 
  3.767941924926056*^9, 3.7679468600883512`*^9, 3.7679469811858597`*^9, 
  3.7679484531718073`*^9, 3.7679608672497787`*^9, 3.767960934911785*^9, 
  3.7679609720172253`*^9, 3.767962160407777*^9, 3.767962428452011*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tZZ1", " ", "=", 
  RowBox[{"CForm", "[", 
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sVZ", " ", "//.", " ", "ruleRHS"}], " ", "//.", " ", 
      RowBox[{"DET", "->", "1"}]}], ",", " ", "z1"}], "]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.767591064507258*^9, 3.767591070033517*^9}, {
   3.767591204061858*^9, 3.767591241881761*^9}, {3.767591312805808*^9, 
   3.767591332870707*^9}, 3.767591376238578*^9, 3.7675914083271513`*^9, 
   3.7675941844777718`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]],

Cell["\<\
axy*axz*cosA1*syz1 - axx*ayz*cosA1*syz1 + axz*ayy*sinA1*syz1 - \
axy*ayz*sinA1*syz1 - Power(axy,2)*szz1 + axx*ayy*szz1\
\>", "Output",
 CellChangeTimes->{3.767936042715012*^9, 3.76793728566258*^9, 
  3.7679386766496677`*^9, 3.767941015652247*^9, 3.767941257530259*^9, 
  3.767941926498269*^9, 3.767946861147558*^9, 3.7679469812899714`*^9, 
  3.7679484539334383`*^9, 3.767960867263754*^9, 3.767960935237582*^9, 
  3.767960972360525*^9, 3.7679621607842817`*^9, 3.7679624292080507`*^9},
 FontColor->RGBColor[1, 0, 0],
 Background->RGBColor[0.87, 0.94, 1]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2) After having the PCA as a function of track points position we minimize \
the chi2 wrt these tracks positions (functions of the track parameters X):\
\>", "Section",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
  3.767934412119769*^9, 3.767934414814303*^9}, {3.767934867601762*^9, 
  3.767934999762636*^9}, {3.767936346349793*^9, 3.7679364265065403`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "XX0", ",", "XX1", ",", "XY0", ",", "XY1", ",", "XZ0", ",", "XZ1", ",", 
      " ", "YX0", ",", "YX1", ",", "YY0", ",", "YY1", ",", "YZ0", ",", "YZ1", 
      ",", "ZX0", ",", "ZX1", ",", "ZY0", ",", "ZY1", ",", "ZZ0", ",", 
      "ZZ1"}], "}"}], ",", "Constant"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"x1", ",", "x0"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"y1", ",", "x0"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"z1", ",", "x0"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"x0", ",", "x1"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"y0", ",", "x1"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"z0", ",", "x1"}], "]"}], "=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"x0", ",", "x1", ",", "x0"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"x1", ",", "x0", ",", "x1"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"y0", ",", "x1", ",", "x0"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"y1", ",", "x0", ",", " ", "x1"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"z0", ",", "x1", ",", " ", "x0"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"z1", ",", "x0", ",", " ", "x1"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"x0", ",", "x0", ",", "x1"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"x1", ",", "x1", ",", "x0"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"y0", ",", "x0", ",", "x1"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"y1", ",", "x1", ",", " ", "x0"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"z0", ",", "x0", ",", " ", "x1"}], "]"}], " ", "=", " ", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"z1", ",", "x1", ",", " ", "x0"}], "]"}], " ", "=", " ", "0"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.767936953612701*^9, {3.7679371429387283`*^9, 3.767937144289352*^9}, {
   3.767937526771894*^9, 3.767937547450591*^9}, {3.7679377220838757`*^9, 
   3.76793772332082*^9}, {3.767937823477104*^9, 3.7679378247794247`*^9}},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VX", " ", "=", " ", 
   RowBox[{
    RowBox[{"x0", " ", "XX0"}], " ", "+", " ", 
    RowBox[{"y0", " ", "XY0"}], " ", "+", " ", 
    RowBox[{"z0", " ", "XZ0"}], " ", "+", " ", 
    RowBox[{"x1", " ", "XX1"}], " ", "+", " ", 
    RowBox[{"y1", " ", "XY1"}], " ", "+", " ", 
    RowBox[{"z1", " ", "XZ1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VY", " ", "=", " ", 
   RowBox[{
    RowBox[{"x0", " ", "YX0"}], " ", "+", " ", 
    RowBox[{"y0", " ", "YY0"}], " ", "+", " ", 
    RowBox[{"z0", " ", "YZ0"}], " ", "+", " ", 
    RowBox[{"x1", " ", "YX1"}], " ", "+", " ", 
    RowBox[{"y1", " ", "YY1"}], " ", "+", " ", 
    RowBox[{"z1", " ", "YZ1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"VZ", " ", "=", " ", 
   RowBox[{
    RowBox[{"x0", " ", "ZX0"}], " ", "+", " ", 
    RowBox[{"y0", " ", "ZY0"}], " ", "+", " ", 
    RowBox[{"z0", " ", "ZZ0"}], " ", "+", " ", 
    RowBox[{"x1", " ", "ZX1"}], " ", "+", " ", 
    RowBox[{"y1", " ", "ZY1"}], " ", "+", " ", 
    RowBox[{"z1", " ", "ZZ1"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7668338361652308`*^9, 3.766833944665039*^9}, {
  3.766836475766*^9, 3.7668365778640633`*^9}, {3.767353781973168*^9, 
  3.7673537883533983`*^9}, {3.767937403918346*^9, 3.767937406323675*^9}, {
  3.7679390729508753`*^9, 3.767939073585372*^9}}],

Cell[CellGroupData[{

Cell["Some abbreviations to keep notation short :", "Subsubsection",
 CellChangeTimes->{{3.7679374700374317`*^9, 3.767937503497245*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ddx0Dx0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dx0", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy0Dx0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dy0", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddz0Dx0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dz0", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx1Dx1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dx1", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy1Dx1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dy1", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ddz1Dx1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"dz1", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Ddx0Dx1", " ", "=", " ", 
  RowBox[{
   RowBox[{"Dt", "[", 
    RowBox[{"dx0", ",", "x1"}], "]"}], "//.", " ", 
   "RuleD0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy0Dx1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dy0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddz0Dx1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dz0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx1Dx0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dx1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy1Dx0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dy1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ddz1Dx0", " ", "=", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"dz1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx0Dx0x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddx0Dx0", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy0Dx0x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddy0Dx0", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddz0Dx0x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddz0Dx0", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx1Dx1x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddx1Dx1", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy1Dx1x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddy1Dx1", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ddz1Dx1x1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"Ddz1Dx1", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx0Dx0x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddx0Dx0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy0Dx0x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddy0Dx0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddz0Dx0x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddz0Dx0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx1Dx1x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddx1Dx1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy1Dx1x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddy1Dx1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ddz1Dx1x0", " ", "=", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"Ddz1Dx1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx0Dx1x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddx0Dx1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy0Dx1x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddy0Dx1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddz0Dx1x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddz0Dx1", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx1Dx0x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddx1Dx0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy1Dx0x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddy1Dx0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ddz1Dx0x1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"Ddz1Dx0", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddx1Dx0x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddx1Dx0", ",", "x0"}], "]"}], "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ddx0Dx1x1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"Ddx0Dx1", ",", "x1"}], "]"}], "//.", " ", "RuleD0"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddy1Dx0x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddy1Dx0", ",", " ", "x0"}], "]"}], " ", "//.", " ", 
    "RuleD0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ddy0Dx1x1", " ", "=", " ", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"Ddy0Dx1", ",", " ", "x1"}], "]"}], " ", "//.", " ", 
     "RuleD0"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddz1Dx0x0", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddz1Dx0", ",", "x0"}], "]"}], " ", "//.", " ", "RuleD0"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ddz0Dx1x1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"Ddz0Dx1", ",", "x1"}], "]"}], " ", "//.", " ", "RuleD0"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7673528014862556`*^9, 3.767352974873789*^9}, {
   3.7673533615945873`*^9, 3.767353368353717*^9}, {3.767353893497281*^9, 
   3.767354013520056*^9}, 3.76794002746698*^9, {3.767940133405292*^9, 
   3.767940316929763*^9}, 3.767941032172694*^9, {3.767960722130904*^9, 
   3.767960775750352*^9}, {3.767961899069646*^9, 3.767961950690851*^9}, {
   3.767962037135316*^9, 3.7679620764924173`*^9}, 3.767962243839264*^9, {
   3.767962467756692*^9, 3.767962476118866*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "cosA0"}], " ", 
   RowBox[{"(", 
    RowBox[{"XX1", "+", 
     RowBox[{"XY1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
     RowBox[{"XZ1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}], "-", 
  RowBox[{"sinA0", " ", 
   RowBox[{"(", 
    RowBox[{"YX1", "+", 
     RowBox[{"YY1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
     RowBox[{"YZ1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.767962430107258*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceRepeated", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({Rule0}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ReplaceRepeated/reps\\\", ButtonNote -> \\\
\"ReplaceRepeated::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7679624304666023`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceRepeated", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({Rule0}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ReplaceRepeated/reps\\\", ButtonNote -> \\\
\"ReplaceRepeated::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.767962430628866*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceRepeated", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({Rule0}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ReplaceRepeated/reps\\\", ButtonNote -> \\\
\"ReplaceRepeated::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7679624306354513`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"ReplaceRepeated", "::", "reps"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\({Rule0}\\)\[NoBreak] is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ReplaceRepeated/reps\\\", ButtonNote -> \\\
\"ReplaceRepeated::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.767962430641605*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dx0", ",", "x0"}], "]"}], " ", "=", " ", "FDdx0Dx0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dx1", ",", "x1"}], "]"}], " ", "=", " ", "FDdx1Dx1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dy0", ",", "x0"}], "]"}], " ", "=", " ", "FDdy0Dx0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dy1", ",", "x1"}], "]"}], " ", "=", " ", "FDdy1Dx1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dz0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dz0", ",", "x0"}], "]"}], " ", "=", " ", "FDdz0Dx0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dz1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dz1", ",", "x1"}], "]"}], " ", "=", " ", "FDdz1Dx1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dx0", ",", "x1"}], "]"}], " ", "=", " ", "FDdx0Dx1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dx1", ",", "x0"}], "]"}], " ", "=", " ", "FDdx1Dx0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dy0", ",", "x1"}], "]"}], " ", "=", " ", "FDdy0Dx1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dy1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dy1", ",", "x0"}], "]"}], " ", "=", " ", "FDdy1Dx0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dz0", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dz0", ",", "x1"}], "]"}], " ", "=", " ", "FDdz0Dx1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dz1", " ", "/:", " ", 
   RowBox[{"Dt", "[", 
    RowBox[{"dz1", ",", "x0"}], "]"}], " ", "=", " ", "FDdz1Dx0"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.76793912539937*^9, 3.767939188033771*^9}, 
   3.76793928691636*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"FDdx0Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx0Dx0", ",", "x0"}], "]"}], " ", "=", " ", "FDdx0Dx0x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy0Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy0Dx0", ",", "x0"}], "]"}], " ", "=", " ", "FDdy0Dx0x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdz0Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdz0Dx0", ",", "x0"}], "]"}], " ", "=", " ", "FDdz0Dx0x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdx1Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx1Dx1", ",", "x1"}], "]"}], " ", "=", " ", "FDdx1Dx1x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy1Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy1Dx1", ",", "x1"}], "]"}], " ", "=", " ", "FDdy1Dx1x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdz1Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdz1Dx1", ",", "x1"}], "]"}], " ", "=", " ", "FDdz1Dx1x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdx0Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx0Dx0", ",", "x1"}], "]"}], " ", "=", " ", "FDdx0Dx0x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy0Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy0Dx0", ",", "x1"}], "]"}], " ", "=", " ", "FDdy0Dx0x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdz0Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdz0Dx0", ",", "x1"}], "]"}], " ", "=", " ", "FDdz0Dx0x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdx1Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx1Dx1", ",", "x0"}], "]"}], " ", "=", " ", "FDdx1Dx1x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy1Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy1Dx1", ",", "x0"}], "]"}], " ", "=", " ", "FDdy1Dx1x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FDdz1Dx1", " ", "/:", 
    RowBox[{"Dt", "[", 
     RowBox[{"FDdz1Dx1", ",", "x0"}], "]"}], " ", "=", " ", "FDdz1Dx1x0"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdx0Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx0Dx1", ",", "x0"}], "]"}], " ", "=", " ", "FDdx0Dx1x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy0Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy0Dx1", ",", "x0"}], "]"}], " ", "=", " ", "FDdy0Dx1x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdz0Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdz0Dx1", ",", "x0"}], "]"}], " ", "=", " ", "FDdz0Dx1x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdx1Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx1Dx0", ",", "x1"}], "]"}], " ", "=", " ", "FDdx1Dx0x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy1Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy1Dx0", ",", "x1"}], "]"}], " ", "=", " ", "FDdy1Dx0x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdz1Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdz1Dx0", ",", "x1"}], "]"}], " ", "=", " ", "FDdz1Dx0x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdx0Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx0Dx1", ",", "x1"}], "]"}], " ", "=", " ", "FDdx0Dx1x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy0Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy0Dx1", ",", "x1"}], "]"}], " ", "=", " ", "FDdy0Dx1x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdz0Dx1", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdz0Dx1", ",", "x1"}], "]"}], " ", "=", " ", "FDdz0Dx1x1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdx1Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdx1Dx0", ",", "x0"}], "]"}], " ", "=", " ", "FDdx1Dx0x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdy1Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdy1Dx0", ",", "x0"}], "]"}], " ", "=", " ", "FDdy1Dx0x0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FDdz1Dx0", " ", "/:", 
   RowBox[{"Dt", "[", 
    RowBox[{"FDdz1Dx0", ",", "x0"}], "]"}], " ", "=", " ", "FDdz1Dx0x0"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.767939307916464*^9, 3.767939346212235*^9}, {
  3.767939420757001*^9, 3.767939607348275*^9}, {3.767939690925441*^9, 
  3.767939698604815*^9}, {3.767939748759418*^9, 3.767939856950304*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RuleDD", " ", "=", " ", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FDdx0Dx0", "->", "Ddx0Dx0"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdy0Dx0", "->", "Ddy0Dx0"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdz0Dx0", "->", "Ddz0Dx0"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdx1Dx1", "->", "Ddx1Dx1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FDdy1Dx1", "->", "Ddy1Dx1"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdz1Dx1", "->", "Ddz1Dx1"}], ",", " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx0Dx1", "->", "Ddx0Dx1"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdy0Dx1", "->", "Ddy0Dx1"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdz0Dx1", "->", "Ddz0Dx1"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdx1Dx0", "->", "Ddx1Dx0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FDdy1Dx0", "->", "Ddy1Dx0"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"FDdz1Dx0", "->", "Ddz1Dx0"}], ",", " ", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx0Dx0x0", "->", "Ddx0Dx0x0"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdy0Dx0x0", "->", "Ddy0Dx0x0"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz0Dx0x0", "->", "Ddz0Dx0x0"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx1Dx1x1", "->", "Ddx1Dx1x1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FDdy1Dx1x1", "->", "Ddy1Dx1x1"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz1Dx1x1", "->", "Ddz1Dx1x1"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx0Dx1x1", "->", "Ddx0Dx1x1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FDdy0Dx1x1", " ", "->", "Ddy0Dx1x1"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz0Dx1x1", " ", "\[Rule]", " ", "Ddz0Dx1x1"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx1Dx0x0", "->", "Ddx1Dx0x0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FDdy1Dx0x0", " ", "->", "Ddy1Dx0x0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz1Dx0x0", " ", "\[Rule]", " ", "Ddz1Dx0x0"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"FDdx0Dx0x1", "->", "Ddx0Dx0x1"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdy0Dx0x1", "->", "Ddy0Dx0x1"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz0Dx0x1", "->", "Ddz0Dx0x1"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx1Dx1x0", "->", "Ddx1Dx1x0"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FDdy1Dx1x0", "->", "Ddy1Dx1x0"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz1Dx1x0", "->", "Ddz1Dx1x0"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx0Dx1x0", "->", "Ddx0Dx1x0"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdy0Dx1x0", "->", "Ddy0Dx1x0"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz0Dx1x0", "->", "Ddz0Dx1x0"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdx1Dx0x1", "->", "Ddx1Dx0x1"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FDdy1Dx0x1", "->", "Ddy1Dx0x1"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"FDdz1Dx0x1", "->", "Ddz1Dx0x1"}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.767940356879047*^9, 3.7679404750036716`*^9}, {
  3.767940577808688*^9, 3.767940658628497*^9}, {3.7679407690697193`*^9, 
  3.767940922394814*^9}, {3.767941143021583*^9, 3.767941197847*^9}, {
  3.767960824810763*^9, 3.7679608590944*^9}, {3.767960896290954*^9, 
  3.767960957249487*^9}, {3.7679619897382593`*^9, 3.767962019752739*^9}, {
  3.767962098181444*^9, 3.767962145675861*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"FDdx0Dx0", "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"cosA0", " ", 
      RowBox[{"(", 
       RowBox[{"XX0", "+", 
        RowBox[{"XY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"XZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA0", " ", 
      RowBox[{"(", 
       RowBox[{"YX0", "+", 
        RowBox[{"YY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"YZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy0Dx0", "\[Rule]", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"y0", ",", "x0"}], "]"}], "+", 
     RowBox[{"sinA0", " ", 
      RowBox[{"(", 
       RowBox[{"XX0", "+", 
        RowBox[{"XY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"XZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"cosA0", " ", 
      RowBox[{"(", 
       RowBox[{"YX0", "+", 
        RowBox[{"YY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"YZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdz0Dx0", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "ZX0"}], "-", 
     RowBox[{"ZY0", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
     RowBox[{"Dt", "[", 
      RowBox[{"z0", ",", "x0"}], "]"}], "-", 
     RowBox[{"ZZ0", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z0", ",", "x0"}], "]"}]}]}]}], ",", 
   RowBox[{"FDdx1Dx1", "\[Rule]", 
    RowBox[{"1", "-", 
     RowBox[{"cosA1", " ", 
      RowBox[{"(", 
       RowBox[{"XX1", "+", 
        RowBox[{"XY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"XZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA1", " ", 
      RowBox[{"(", 
       RowBox[{"YX1", "+", 
        RowBox[{"YY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"YZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy1Dx1", "\[Rule]", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"y1", ",", "x1"}], "]"}], "+", 
     RowBox[{"sinA1", " ", 
      RowBox[{"(", 
       RowBox[{"XX1", "+", 
        RowBox[{"XY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"XZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"cosA1", " ", 
      RowBox[{"(", 
       RowBox[{"YX1", "+", 
        RowBox[{"YY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"YZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdz1Dx1", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "ZX1"}], "-", 
     RowBox[{"ZY1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
     RowBox[{"Dt", "[", 
      RowBox[{"z1", ",", "x1"}], "]"}], "-", 
     RowBox[{"ZZ1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z1", ",", "x1"}], "]"}]}]}]}], ",", 
   RowBox[{"FDdx0Dx1", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cosA0"}], " ", 
      RowBox[{"(", 
       RowBox[{"XX1", "+", 
        RowBox[{"XY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"XZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA0", " ", 
      RowBox[{"(", 
       RowBox[{"YX1", "+", 
        RowBox[{"YY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"YZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy0Dx1", "\[Rule]", 
    RowBox[{
     RowBox[{"sinA0", " ", 
      RowBox[{"(", 
       RowBox[{"XX1", "+", 
        RowBox[{"XY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"XZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"cosA0", " ", 
      RowBox[{"(", 
       RowBox[{"YX1", "+", 
        RowBox[{"YY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", "x1"}], "]"}]}], "+", 
        RowBox[{"YZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", "x1"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdz0Dx1", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "ZX1"}], "-", 
     RowBox[{"ZY1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y1", ",", "x1"}], "]"}]}], "-", 
     RowBox[{"ZZ1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z1", ",", "x1"}], "]"}]}]}]}], ",", 
   RowBox[{"FDdx1Dx0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cosA1"}], " ", 
      RowBox[{"(", 
       RowBox[{"XX0", "+", 
        RowBox[{"XY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"XZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA1", " ", 
      RowBox[{"(", 
       RowBox[{"YX0", "+", 
        RowBox[{"YY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"YZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy1Dx0", "\[Rule]", 
    RowBox[{
     RowBox[{"sinA1", " ", 
      RowBox[{"(", 
       RowBox[{"XX0", "+", 
        RowBox[{"XY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"XZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"cosA1", " ", 
      RowBox[{"(", 
       RowBox[{"YX0", "+", 
        RowBox[{"YY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", "x0"}], "]"}]}], "+", 
        RowBox[{"YZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", "x0"}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdz1Dx0", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "ZX0"}], "-", 
     RowBox[{"ZY0", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y0", ",", "x0"}], "]"}]}], "-", 
     RowBox[{"ZZ0", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z0", ",", "x0"}], "]"}]}]}]}], ",", 
   RowBox[{"FDdx0Dx0x0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cosA0"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"XZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"YZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy0Dx0x0", "\[Rule]", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"y0", ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", "2"}], "}"}]}], "]"}], "+", 
     RowBox[{"sinA0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"XZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"cosA0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"YZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdz0Dx0x0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "ZY0"}], " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y0", ",", 
        RowBox[{"{", 
         RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"Dt", "[", 
      RowBox[{"z0", ",", 
       RowBox[{"{", 
        RowBox[{"x0", ",", "2"}], "}"}]}], "]"}], "-", 
     RowBox[{"ZZ0", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z0", ",", 
        RowBox[{"{", 
         RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", 
   RowBox[{"FDdx1Dx1x1", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cosA1"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"XZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"YZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy1Dx1x1", "\[Rule]", 
    RowBox[{
     RowBox[{"Dt", "[", 
      RowBox[{"y1", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "2"}], "}"}]}], "]"}], "+", 
     RowBox[{"sinA1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"XZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"cosA1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"YZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdz1Dx1x1", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "ZY1"}], " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"y1", ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
     RowBox[{"Dt", "[", 
      RowBox[{"z1", ",", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "2"}], "}"}]}], "]"}], "-", 
     RowBox[{"ZZ1", " ", 
      RowBox[{"Dt", "[", 
       RowBox[{"z1", ",", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}]}], ",", 
   RowBox[{"FDdx0Dx1x1", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cosA0"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"XZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YY1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"YZ1", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z1", ",", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy0Dx1x1", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"sinA0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XY1", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"y1", ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
          RowBox[{"XZ1", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"z1", ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"cosA0", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"YY1", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"y1", ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "+", 
          RowBox[{"YZ1", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"z1", ",", 
             RowBox[{"{", 
              RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], "//.", 
      "\[VeryThinSpace]", "Rule0"}], ")"}]}], ",", 
   RowBox[{"FDdz0Dx1x1", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "ZY1"}], " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"y1", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}], "-", 
       RowBox[{"ZZ1", " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"z1", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "2"}], "}"}]}], "]"}]}]}], "//.", 
      "\[VeryThinSpace]", "Rule0"}], ")"}]}], ",", 
   RowBox[{"FDdx1Dx0x0", "\[Rule]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "cosA1"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"XZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"sinA1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YY0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"y0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
        RowBox[{"YZ0", " ", 
         RowBox[{"Dt", "[", 
          RowBox[{"z0", ",", 
           RowBox[{"{", 
            RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{"FDdy1Dx0x0", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"sinA1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XY0", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"y0", ",", 
             RowBox[{"{", 
              RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
          RowBox[{"XZ0", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"z0", ",", 
             RowBox[{"{", 
              RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}], "-", 
       RowBox[{"cosA1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"YY0", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"y0", ",", 
             RowBox[{"{", 
              RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "+", 
          RowBox[{"YZ0", " ", 
           RowBox[{"Dt", "[", 
            RowBox[{"z0", ",", 
             RowBox[{"{", 
              RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], ")"}]}]}], "//.", 
      "\[VeryThinSpace]", "Rule0"}], ")"}]}], ",", 
   RowBox[{"FDdz1Dx0x0", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "ZY0"}], " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"y0", ",", 
          RowBox[{"{", 
           RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}], "-", 
       RowBox[{"ZZ0", " ", 
        RowBox[{"Dt", "[", 
         RowBox[{"z0", ",", 
          RowBox[{"{", 
           RowBox[{"x0", ",", "2"}], "}"}]}], "]"}]}]}], "//.", 
      "\[VeryThinSpace]", "Rule0"}], ")"}]}], ",", 
   RowBox[{"FDdx0Dx0x1", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdy0Dx0x1", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdz0Dx0x1", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdx1Dx1x0", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdy1Dx1x0", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdz1Dx1x0", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdx0Dx1x0", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdy0Dx1x0", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdz0Dx1x0", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdx1Dx0x1", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdy1Dx0x1", "\[Rule]", "0"}], ",", 
   RowBox[{"FDdz1Dx0x1", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.767939970109877*^9, 3.767940008484789*^9, 3.767940929453889*^9, 
   3.767941016345722*^9, 3.767941258493333*^9, 3.767941933186468*^9, 
   3.7679468695940657`*^9, 3.7679469818095007`*^9, 3.767948455470701*^9, 
   3.767960867708918*^9, 3.767960936421427*^9, 3.7679609736719503`*^9, {
   3.767962148126593*^9, 3.767962163617475*^9}, 3.7679624314656553`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1 st derivative :", "Subsubsection",
 CellChangeTimes->{{3.766839974672379*^9, 3.766839988810625*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dChidx0", " ", "=", " ", 
  RowBox[{"Dt", "[", 
   RowBox[{"chi2", ",", "x0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dChidx1", " ", "=", " ", 
  RowBox[{"Dt", "[", 
   RowBox[{"chi2", ",", "x1"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.766836002988896*^9, 3.766836017651558*^9}, {
   3.766837912909569*^9, 3.766837917734929*^9}, 3.766838251923818*^9, {
   3.7668398989886312`*^9, 3.766839964242696*^9}, {3.7668400316721983`*^9, 
   3.7668400522861767`*^9}, {3.7668402917844543`*^9, 3.766840292826702*^9}, {
   3.767350674520156*^9, 3.767350681110783*^9}, {3.767350882920133*^9, 
   3.7673508840886927`*^9}, {3.767939193311792*^9, 3.767939196955275*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dx0", " ", "FDdx0Dx0", " ", "sxx0"}], "+", 
     RowBox[{"2", " ", "dx1", " ", "FDdx1Dx0", " ", "sxx1"}]}], ")"}]}], "+", 
  
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dy0", " ", "FDdy0Dx0", " ", "syy0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdy0Dx0", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dy0", " ", "FDdz0Dx0", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdz0Dx0", " ", "szz0"}]}], ")"}]}], "+", 
  
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dy1", " ", "FDdy1Dx0", " ", "syy1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdy1Dx0", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dy1", " ", "FDdz1Dx0", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdz1Dx0", " ", "szz1"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7679378647427177`*^9, 3.767938690583118*^9, {3.7679391936432*^9, 
   3.767939198090061*^9}, 3.7679393523085012`*^9, 3.767939881962824*^9, 
   3.7679410164392557`*^9, 3.767941258520376*^9, 3.7679419336134768`*^9, 
   3.767946871362636*^9, 3.767946981925282*^9, 3.7679484559217367`*^9, 
   3.767960867729333*^9, 3.7679609364406*^9, 3.767960974012607*^9, 
   3.767962163851166*^9, 3.76796243186793*^9},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dx0", " ", "FDdx0Dx1", " ", "sxx0"}], "+", 
     RowBox[{"2", " ", "dx1", " ", "FDdx1Dx1", " ", "sxx1"}]}], ")"}]}], "+", 
  
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dy0", " ", "FDdy0Dx1", " ", "syy0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdy0Dx1", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dy0", " ", "FDdz0Dx1", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdz0Dx1", " ", "szz0"}]}], ")"}]}], "+", 
  
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dy1", " ", "FDdy1Dx1", " ", "syy1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdy1Dx1", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dy1", " ", "FDdz1Dx1", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdz1Dx1", " ", "szz1"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7679378647427177`*^9, 3.767938690583118*^9, {3.7679391936432*^9, 
   3.767939198090061*^9}, 3.7679393523085012`*^9, 3.767939881962824*^9, 
   3.7679410164392557`*^9, 3.767941258520376*^9, 3.7679419336134768`*^9, 
   3.767946871362636*^9, 3.767946981925282*^9, 3.7679484559217367`*^9, 
   3.767960867729333*^9, 3.7679609364406*^9, 3.767960974012607*^9, 
   3.767962163851166*^9, 3.7679624318764763`*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", "dChidx0", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.767946383225664*^9, 3.767946403963313*^9}}],

Cell["\<\
dx0*FDdx0Dx0*sxx0 + dx1*FDdx1Dx0*sxx1 + dy0*FDdy0Dx0*syy0 + dy1*FDdy1Dx0*syy1 \
+ dz0*FDdy0Dx0*syz0 + dy0*FDdz0Dx0*syz0 + dz1*FDdy1Dx0*syz1 + \
dy1*FDdz1Dx0*syz1 + dz0*FDdz0Dx0*szz0 + dz1*FDdz1Dx0*szz1\
\>", "Output",
 CellChangeTimes->{3.767946404733231*^9, 3.767946873657571*^9, 
  3.767946982205985*^9, 3.767948456785314*^9, 3.767960867899891*^9, 
  3.767960936817822*^9, 3.767960974388174*^9, 3.767962164276062*^9, 
  3.76796243222651*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", "dChidx1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7679464201985083`*^9, 3.76794642027392*^9}}],

Cell["\<\
dx0*FDdx0Dx1*sxx0 + dx1*FDdx1Dx1*sxx1 + dy0*FDdy0Dx1*syy0 + dy1*FDdy1Dx1*syy1 \
+ dz0*FDdy0Dx1*syz0 + dy0*FDdz0Dx1*syz0 + dz1*FDdy1Dx1*syz1 + \
dy1*FDdz1Dx1*syz1 + dz0*FDdz0Dx1*szz0 + dz1*FDdz1Dx1*szz1\
\>", "Output",
 CellChangeTimes->{3.767946422285911*^9, 3.7679468740980053`*^9, 
  3.767946982334421*^9, 3.767948457133477*^9, 3.767960868154964*^9, 
  3.7679609374851713`*^9, 3.767960974655871*^9, 3.7679621644829407`*^9, 
  3.767962433037781*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2 nd derivative (symmetric matrix)\
\>", "Subsubsection",
 CellChangeTimes->{{3.766839994073969*^9, 3.766840012079068*^9}, {
  3.76794842227774*^9, 3.767948428389235*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dChidx0dx0", " ", "=", " ", 
  RowBox[{"Dt", "[", 
   RowBox[{"dChidx0", ",", "x0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dChidx1dx1", " ", "=", " ", 
  RowBox[{"Dt", "[", 
   RowBox[{"dChidx1", ",", "x1"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dChidx0dx1", " ", "=", " ", 
  RowBox[{"Dt", "[", 
   RowBox[{"dChidx0", ",", "x1"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7668400260003433`*^9, 3.7668400905800047`*^9}, {
  3.766840295628592*^9, 3.7668402972519693`*^9}, {3.76794822131357*^9, 
  3.767948232633175*^9}, {3.7679484154438*^9, 3.767948432967148*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["FDdx0Dx0", "2"], " ", "sxx0"}], "+", 
     RowBox[{"2", " ", "dx0", " ", "FDdx0Dx0x0", " ", "sxx0"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["FDdx1Dx0", "2"], " ", "sxx1"}], "+", 
     RowBox[{"2", " ", "dx1", " ", "FDdx1Dx0x0", " ", "sxx1"}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["FDdy0Dx0", "2"], " ", "syy0"}], "+", 
     RowBox[{"2", " ", "dy0", " ", "FDdy0Dx0x0", " ", "syy0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdy0Dx0x0", " ", "syz0"}], "+", 
     RowBox[{"4", " ", "FDdy0Dx0", " ", "FDdz0Dx0", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dy0", " ", "FDdz0Dx0x0", " ", "syz0"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["FDdz0Dx0", "2"], " ", "szz0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdz0Dx0x0", " ", "szz0"}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["FDdy1Dx0", "2"], " ", "syy1"}], "+", 
     RowBox[{"2", " ", "dy1", " ", "FDdy1Dx0x0", " ", "syy1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdy1Dx0x0", " ", "syz1"}], "+", 
     RowBox[{"4", " ", "FDdy1Dx0", " ", "FDdz1Dx0", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dy1", " ", "FDdz1Dx0x0", " ", "syz1"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["FDdz1Dx0", "2"], " ", "szz1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdz1Dx0x0", " ", "szz1"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.767937873241798*^9, 3.7679386943402233`*^9, 3.767939216259224*^9, 
   3.767939357487626*^9, 3.7679398887958183`*^9, 3.767941016543819*^9, 
   3.7679412587408543`*^9, 3.767941934864518*^9, 3.767946874419375*^9, 
   3.7679469824590816`*^9, {3.767948233696838*^9, 3.7679482437966547`*^9}, 
   3.7679484574911737`*^9, 3.767960868171736*^9, 3.767960937503435*^9, 
   3.7679609748958807`*^9, 3.767962164512519*^9, 3.76796243338227*^9},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["FDdx0Dx1", "2"], " ", "sxx0"}], "+", 
     RowBox[{"2", " ", "dx0", " ", "FDdx0Dx1x1", " ", "sxx0"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["FDdx1Dx1", "2"], " ", "sxx1"}], "+", 
     RowBox[{"2", " ", "dx1", " ", "FDdx1Dx1x1", " ", "sxx1"}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["FDdy0Dx1", "2"], " ", "syy0"}], "+", 
     RowBox[{"2", " ", "dy0", " ", "FDdy0Dx1x1", " ", "syy0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdy0Dx1x1", " ", "syz0"}], "+", 
     RowBox[{"4", " ", "FDdy0Dx1", " ", "FDdz0Dx1", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dy0", " ", "FDdz0Dx1x1", " ", "syz0"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["FDdz0Dx1", "2"], " ", "szz0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdz0Dx1x1", " ", "szz0"}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      SuperscriptBox["FDdy1Dx1", "2"], " ", "syy1"}], "+", 
     RowBox[{"2", " ", "dy1", " ", "FDdy1Dx1x1", " ", "syy1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdy1Dx1x1", " ", "syz1"}], "+", 
     RowBox[{"4", " ", "FDdy1Dx1", " ", "FDdz1Dx1", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dy1", " ", "FDdz1Dx1x1", " ", "syz1"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["FDdz1Dx1", "2"], " ", "szz1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdz1Dx1x1", " ", "szz1"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.767937873241798*^9, 3.7679386943402233`*^9, 3.767939216259224*^9, 
   3.767939357487626*^9, 3.7679398887958183`*^9, 3.767941016543819*^9, 
   3.7679412587408543`*^9, 3.767941934864518*^9, 3.767946874419375*^9, 
   3.7679469824590816`*^9, {3.767948233696838*^9, 3.7679482437966547`*^9}, 
   3.7679484574911737`*^9, 3.767960868171736*^9, 3.767960937503435*^9, 
   3.7679609748958807`*^9, 3.767962164512519*^9, 3.767962433391945*^9},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dx0", " ", "FDdx0Dx0x1", " ", "sxx0"}], "+", 
     RowBox[{"2", " ", "FDdx0Dx0", " ", "FDdx0Dx1", " ", "sxx0"}], "+", 
     RowBox[{"2", " ", "dx1", " ", "FDdx1Dx0x1", " ", "sxx1"}], "+", 
     RowBox[{"2", " ", "FDdx1Dx0", " ", "FDdx1Dx1", " ", "sxx1"}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dy0", " ", "FDdy0Dx0x1", " ", "syy0"}], "+", 
     RowBox[{"2", " ", "FDdy0Dx0", " ", "FDdy0Dx1", " ", "syy0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdy0Dx0x1", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "FDdy0Dx1", " ", "FDdz0Dx0", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dy0", " ", "FDdz0Dx0x1", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "FDdy0Dx0", " ", "FDdz0Dx1", " ", "syz0"}], "+", 
     RowBox[{"2", " ", "dz0", " ", "FDdz0Dx0x1", " ", "szz0"}], "+", 
     RowBox[{"2", " ", "FDdz0Dx0", " ", "FDdz0Dx1", " ", "szz0"}]}], ")"}]}], 
  "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "dy1", " ", "FDdy1Dx0x1", " ", "syy1"}], "+", 
     RowBox[{"2", " ", "FDdy1Dx0", " ", "FDdy1Dx1", " ", "syy1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdy1Dx0x1", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "FDdy1Dx1", " ", "FDdz1Dx0", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dy1", " ", "FDdz1Dx0x1", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "FDdy1Dx0", " ", "FDdz1Dx1", " ", "syz1"}], "+", 
     RowBox[{"2", " ", "dz1", " ", "FDdz1Dx0x1", " ", "szz1"}], "+", 
     RowBox[{"2", " ", "FDdz1Dx0", " ", "FDdz1Dx1", " ", "szz1"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.767937873241798*^9, 3.7679386943402233`*^9, 3.767939216259224*^9, 
   3.767939357487626*^9, 3.7679398887958183`*^9, 3.767941016543819*^9, 
   3.7679412587408543`*^9, 3.767941934864518*^9, 3.767946874419375*^9, 
   3.7679469824590816`*^9, {3.767948233696838*^9, 3.7679482437966547`*^9}, 
   3.7679484574911737`*^9, 3.767960868171736*^9, 3.767960937503435*^9, 
   3.7679609748958807`*^9, 3.767962164512519*^9, 3.7679624334011717`*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", "dChidx0dx0", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7679481582782097`*^9, 3.767948161763789*^9}}],

Cell["\<\
Power(FDdx0Dx0,2)*sxx0 + dx0*FDdx0Dx0x0*sxx0 + Power(FDdx1Dx0,2)*sxx1 + \
dx1*FDdx1Dx0x0*sxx1 + Power(FDdy0Dx0,2)*syy0 + dy0*FDdy0Dx0x0*syy0 + \
Power(FDdy1Dx0,2)*syy1 + dy1*FDdy1Dx0x0*syy1 + dz0*FDdy0Dx0x0*syz0 + 
   2*FDdy0Dx0*FDdz0Dx0*syz0 + dy0*FDdz0Dx0x0*syz0 + dz1*FDdy1Dx0x0*syz1 + \
2*FDdy1Dx0*FDdz1Dx0*syz1 + dy1*FDdz1Dx0x0*syz1 + Power(FDdz0Dx0,2)*szz0 + \
dz0*FDdz0Dx0x0*szz0 + Power(FDdz1Dx0,2)*szz1 + dz1*FDdz1Dx0x0*szz1\
\>", "Output",
 CellChangeTimes->{3.767948167196809*^9, 3.7679484580915947`*^9, 
  3.767960868560521*^9, 3.7679609380403214`*^9, 3.767960975581891*^9, 
  3.7679621649949837`*^9, 3.7679624343400087`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", "dChidx1dx1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.767948188526309*^9, 3.767948190037286*^9}}],

Cell["\<\
Power(FDdx0Dx1,2)*sxx0 + dx0*FDdx0Dx1x1*sxx0 + Power(FDdx1Dx1,2)*sxx1 + \
dx1*FDdx1Dx1x1*sxx1 + Power(FDdy0Dx1,2)*syy0 + dy0*FDdy0Dx1x1*syy0 + \
Power(FDdy1Dx1,2)*syy1 + dy1*FDdy1Dx1x1*syy1 + dz0*FDdy0Dx1x1*syz0 + 
   2*FDdy0Dx1*FDdz0Dx1*syz0 + dy0*FDdz0Dx1x1*syz0 + dz1*FDdy1Dx1x1*syz1 + \
2*FDdy1Dx1*FDdz1Dx1*syz1 + dy1*FDdz1Dx1x1*syz1 + Power(FDdz0Dx1,2)*szz0 + \
dz0*FDdz0Dx1x1*szz0 + Power(FDdz1Dx1,2)*szz1 + dz1*FDdz1Dx1x1*szz1\
\>", "Output",
 CellChangeTimes->{3.7679482028724537`*^9, 3.767948458473942*^9, 
  3.76796086899461*^9, 3.767960938888996*^9, 3.7679609759168777`*^9, 
  3.767962165581628*^9, 3.7679624346950493`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"FullSimplify", "[", "dChidx0dx1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.767948212251494*^9, 3.7679482123862963`*^9}}],

Cell["\<\
dx0*FDdx0Dx0x1*sxx0 + FDdx0Dx0*FDdx0Dx1*sxx0 + dx1*FDdx1Dx0x1*sxx1 + \
FDdx1Dx0*FDdx1Dx1*sxx1 + dy0*FDdy0Dx0x1*syy0 + FDdy0Dx0*FDdy0Dx1*syy0 + \
dy1*FDdy1Dx0x1*syy1 + FDdy1Dx0*FDdy1Dx1*syy1 + dz0*FDdy0Dx0x1*syz0 + 
   FDdy0Dx1*FDdz0Dx0*syz0 + dy0*FDdz0Dx0x1*syz0 + FDdy0Dx0*FDdz0Dx1*syz0 + \
dz1*FDdy1Dx0x1*syz1 + FDdy1Dx1*FDdz1Dx0*syz1 + dy1*FDdz1Dx0x1*syz1 + \
FDdy1Dx0*FDdz1Dx1*syz1 + dz0*FDdz0Dx0x1*szz0 + FDdz0Dx0*FDdz0Dx1*szz0 + 
   dz1*FDdz1Dx0x1*szz1 + FDdz1Dx0*FDdz1Dx1*szz1\
\>", "Output",
 CellChangeTimes->{3.767948214246093*^9, 3.767948459566484*^9, 
  3.767960869470409*^9, 3.767960939223546*^9, 3.767960976506172*^9, 
  3.767962165870441*^9, 3.7679624355842953`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "RuleDD", "]"}]], "Input",
 CellChangeTimes->{{3.76794146002849*^9, 3.7679414662141647`*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell["\<\
List(Rule(FDdx0Dx0,1 - cosA0*(XX0 + XY0*Dt(y0,x0) + XZ0*Dt(z0,x0)) - \
sinA0*(YX0 + YY0*Dt(y0,x0) + YZ0*Dt(z0,x0))),
   Rule(FDdy0Dx0,Dt(y0,x0) + sinA0*(XX0 + XY0*Dt(y0,x0) + XZ0*Dt(z0,x0)) - \
cosA0*(YX0 + YY0*Dt(y0,x0) + YZ0*Dt(z0,x0))),Rule(FDdz0Dx0,-ZX0 - \
ZY0*Dt(y0,x0) + Dt(z0,x0) - ZZ0*Dt(z0,x0)),
   Rule(FDdx1Dx1,1 - cosA1*(XX1 + XY1*Dt(y1,x1) + XZ1*Dt(z1,x1)) - sinA1*(YX1 \
+ YY1*Dt(y1,x1) + YZ1*Dt(z1,x1))),
   Rule(FDdy1Dx1,Dt(y1,x1) + sinA1*(XX1 + XY1*Dt(y1,x1) + XZ1*Dt(z1,x1)) - \
cosA1*(YX1 + YY1*Dt(y1,x1) + YZ1*Dt(z1,x1))),Rule(FDdz1Dx1,-ZX1 - \
ZY1*Dt(y1,x1) + Dt(z1,x1) - ZZ1*Dt(z1,x1)),
   Rule(FDdx0Dx1,-(cosA0*(XX1 + XY1*Dt(y1,x1) + XZ1*Dt(z1,x1))) - sinA0*(YX1 \
+ YY1*Dt(y1,x1) + YZ1*Dt(z1,x1))),Rule(FDdy0Dx1,sinA0*(XX1 + XY1*Dt(y1,x1) + \
XZ1*Dt(z1,x1)) - cosA0*(YX1 + YY1*Dt(y1,x1) + YZ1*Dt(z1,x1))),
   Rule(FDdz0Dx1,-ZX1 - ZY1*Dt(y1,x1) - \
ZZ1*Dt(z1,x1)),Rule(FDdx1Dx0,-(cosA1*(XX0 + XY0*Dt(y0,x0) + XZ0*Dt(z0,x0))) - \
sinA1*(YX0 + YY0*Dt(y0,x0) + YZ0*Dt(z0,x0))),
   Rule(FDdy1Dx0,sinA1*(XX0 + XY0*Dt(y0,x0) + XZ0*Dt(z0,x0)) - cosA1*(YX0 + \
YY0*Dt(y0,x0) + YZ0*Dt(z0,x0))),Rule(FDdz1Dx0,-ZX0 - ZY0*Dt(y0,x0) - \
ZZ0*Dt(z0,x0)),
   Rule(FDdx0Dx0x0,-(cosA0*(XY0*Dt(y0,List(x0,2)) + XZ0*Dt(z0,List(x0,2)))) - \
sinA0*(YY0*Dt(y0,List(x0,2)) + YZ0*Dt(z0,List(x0,2)))),
   Rule(FDdy0Dx0x0,Dt(y0,List(x0,2)) + sinA0*(XY0*Dt(y0,List(x0,2)) + \
XZ0*Dt(z0,List(x0,2))) - cosA0*(YY0*Dt(y0,List(x0,2)) + \
YZ0*Dt(z0,List(x0,2)))),
   Rule(FDdz0Dx0x0,-(ZY0*Dt(y0,List(x0,2))) + Dt(z0,List(x0,2)) - \
ZZ0*Dt(z0,List(x0,2))),Rule(FDdx1Dx1x1,-(cosA1*(XY1*Dt(y1,List(x1,2)) + \
XZ1*Dt(z1,List(x1,2)))) - sinA1*(YY1*Dt(y1,List(x1,2)) + \
YZ1*Dt(z1,List(x1,2)))),
   Rule(FDdy1Dx1x1,Dt(y1,List(x1,2)) + sinA1*(XY1*Dt(y1,List(x1,2)) + \
XZ1*Dt(z1,List(x1,2))) - cosA1*(YY1*Dt(y1,List(x1,2)) + \
YZ1*Dt(z1,List(x1,2)))),
   Rule(FDdz1Dx1x1,-(ZY1*Dt(y1,List(x1,2))) + Dt(z1,List(x1,2)) - \
ZZ1*Dt(z1,List(x1,2))),Rule(FDdx0Dx1x1,-(cosA0*(XY1*Dt(y1,List(x1,2)) + \
XZ1*Dt(z1,List(x1,2)))) - sinA0*(YY1*Dt(y1,List(x1,2)) + \
YZ1*Dt(z1,List(x1,2)))),
   Rule(FDdy0Dx1x1,ReplaceRepeated(sinA0*(XY1*Dt(y1,List(x1,2)) + \
XZ1*Dt(z1,List(x1,2))) - cosA0*(YY1*Dt(y1,List(x1,2)) + \
YZ1*Dt(z1,List(x1,2))),Rule0)),
   Rule(FDdz0Dx1x1,ReplaceRepeated(-(ZY1*Dt(y1,List(x1,2))) - \
ZZ1*Dt(z1,List(x1,2)),Rule0)),Rule(FDdx1Dx0x0,-(cosA1*(XY0*Dt(y0,List(x0,2)) \
+ XZ0*Dt(z0,List(x0,2)))) - sinA1*(YY0*Dt(y0,List(x0,2)) + \
YZ0*Dt(z0,List(x0,2)))),
   Rule(FDdy1Dx0x0,ReplaceRepeated(sinA1*(XY0*Dt(y0,List(x0,2)) + \
XZ0*Dt(z0,List(x0,2))) - cosA1*(YY0*Dt(y0,List(x0,2)) + \
YZ0*Dt(z0,List(x0,2))),Rule0)),
   Rule(FDdz1Dx0x0,ReplaceRepeated(-(ZY0*Dt(y0,List(x0,2))) - \
ZZ0*Dt(z0,List(x0,2)),Rule0)),Rule(FDdx0Dx0x1,0),Rule(FDdy0Dx0x1,0),Rule(\
FDdz0Dx0x1,0),Rule(FDdx1Dx1x0,0),Rule(FDdy1Dx1x0,0),Rule(FDdz1Dx1x0,0),Rule(\
FDdx0Dx1x0,0),
   Rule(FDdy0Dx1x0,0),Rule(FDdz0Dx1x0,0),Rule(FDdx1Dx0x1,0),Rule(FDdy1Dx0x1,0)\
,Rule(FDdz1Dx0x1,0))\
\>", "Output",
 CellChangeTimes->{3.767941466960202*^9, 3.7679419359424753`*^9, 
  3.767946874470607*^9, 3.767946982711795*^9, 3.767948459958188*^9, 
  3.767960869486813*^9, 3.7679609395462313`*^9, 3.767960976527142*^9, 
  3.767962165888908*^9, 3.767962435606275*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
3) It remains to derive the expressions for the ExternalTrackParam \
coordinares derivates over X-parameter(equations above use only 1st and 2nd \
derivatives, here we go up to 3d)\
\>", "Section",
 CellChangeTimes->{{3.767934159811905*^9, 3.767934279198554*^9}, {
  3.767934412119769*^9, 3.767934414814303*^9}, {3.767934867601762*^9, 
  3.767934999762636*^9}, {3.767936346349793*^9, 3.7679364265065403`*^9}, {
  3.767941543488908*^9, 3.767941595087475*^9}, {3.767941647902976*^9, 
  3.767941673136265*^9}}],

Cell[CellGroupData[{

Cell["ETP position variation with step dx :", "Subsection",
 CellChangeTimes->{{3.7668125600987597`*^9, 3.7668125813407593`*^9}, 
   3.767355500517734*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dy", " ", "=", " ", 
   RowBox[{"dx", " ", "dy2dx"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dz", " ", "=", " ", 
   RowBox[{"dx", " ", 
    RowBox[{"(", 
     RowBox[{"c2", "+", 
      RowBox[{"s2", " ", "dy2dx"}]}], ")"}], " ", "tgl"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.766810287535882*^9, 3.766810352871039*^9}, {
  3.766810714232081*^9, 3.766810738492344*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DY2DX", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"s1", "+", "s2"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"c1", "+", "c2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S2", " ", "=", " ", 
   RowBox[{"S1", " ", "+", " ", 
    RowBox[{"C", " ", "DX"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{"S1", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{"1", "-", 
     RowBox[{"S2", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STC1", " ", "=", " ", 
   RowBox[{"S1", "/", "C1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"STC2", " ", "=", " ", 
   RowBox[{"S2", "/", "C2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.766810778742878*^9, 3.766810820941402*^9}, {
  3.766810888934856*^9, 3.766810898797481*^9}, {3.7668114282625237`*^9, 
  3.766811468569005*^9}, {3.766811889897628*^9, 3.7668119283600492`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dydxN", " ", "=", " ", 
  RowBox[{"dy2dx", " ", "//.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s1", "\[Rule]", "S1"}], ",", " ", 
     RowBox[{"c1", "\[Rule]", "C1"}], ",", " ", 
     RowBox[{"s2", "\[Rule]", "S2"}], ",", " ", 
     RowBox[{"c2", "\[Rule]", "C2"}], ",", " ", 
     RowBox[{"dy2dx", "->", "DY2DX"}], ",", " ", 
     RowBox[{"dx", "\[Rule]", "DX"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.767698033937735*^9, 3.7676980349664507`*^9}, {
   3.7676984425415297`*^9, 3.76769846867432*^9}, 3.767698722644491*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9, 
   3.767946982897916*^9, 3.7679484605004177`*^9, 3.767960869647605*^9, 
   3.767960939977151*^9, 3.767960977390526*^9, 3.767962166480528*^9, 
   3.7679624364652443`*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9, 
   3.767946982897916*^9, 3.7679484605004177`*^9, 3.767960869647605*^9, 
   3.767960939977151*^9, 3.767960977390526*^9, 3.767962166480528*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9, 
   3.767946982897916*^9, 3.7679484605004177`*^9, 3.767960869647605*^9, 
   3.767960939977151*^9, 3.767960977390526*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9, 
   3.767946982897916*^9, 3.7679484605004177`*^9, 3.767960869647605*^9, 
   3.767960939977151*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9, 
   3.767946982897916*^9, 3.7679484605004177`*^9, 3.767960869647605*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9, 
   3.767946982897916*^9, 3.7679484605004177`*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9, 
   3.767946982897916*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9, 3.767946876347416*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9, 3.767941936464718*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9, 
   3.76770330408919*^9},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"C", " ", "DX"}], "+", 
   RowBox[{"2", " ", "S1"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.767698469812112*^9, 3.767698545010848*^9, {3.7676987226497107`*^9, 
   3.767698749251341*^9}, 3.767699767765188*^9, 3.767700300386263*^9},
 Background->RGBColor[1, 1, 0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"dydxN", ",", "DX"}], "]"}], " ", "//.", " ", 
  RowBox[{"DX", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.767698478064493*^9, 3.767698497474986*^9}},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"C", " ", 
    SuperscriptBox["S1", "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["S1", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]], "+", 
  FractionBox["C", 
   RowBox[{"2", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["S1", "2"]}]]}]]}]], "Output",
 CellChangeTimes->{{3.767698490035383*^9, 3.767698498076549*^9}, 
   3.7676985463057337`*^9, 3.767698761874051*^9, 3.767699768238882*^9, 
   3.7677003011473083`*^9, 3.767703304113181*^9, 3.767941936791888*^9, 
   3.767946878472857*^9, 3.767946983004932*^9, 3.767948460940072*^9, 
   3.76796086977722*^9, 3.767960940372637*^9, 3.7679609777976913`*^9, 
   3.767962166504416*^9, 3.7679624368905487`*^9},
 Background->RGBColor[1, 1, 0.85]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"c2", "  ", "//.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "S1"}], ",", " ", 
       RowBox[{"c1", "\[Rule]", "C1"}], ",", " ", 
       RowBox[{"s2", "\[Rule]", "S2"}], ",", " ", 
       RowBox[{"c2", "\[Rule]", "C2"}], ",", " ", 
       RowBox[{"dy2dx", "->", "DY2DX"}], ",", " ", 
       RowBox[{"dx", "\[Rule]", "DX"}]}], "}"}]}], ",", "DX"}], "]"}], " ", "//.",
   " ", 
  RowBox[{"DX", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.767700179721999*^9, 3.767700251743301*^9}},
 Background->RGBColor[1, 1, 0.85]],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"C", " ", "S1"}], 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]]]}]], "Output",
 CellChangeTimes->{{3.767700205929823*^9, 3.767700252369742*^9}, 
   3.7677003034254913`*^9, 3.767703304690983*^9, 3.767941936808365*^9, 
   3.767946879008648*^9, 3.767946983152288*^9, 3.7679484617421637`*^9, 
   3.7679608698730793`*^9, 3.767960941128667*^9, 3.767960977813696*^9, 
   3.767962166687086*^9, 3.767962436913135*^9},
 Background->RGBColor[1, 1, 0.85]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RuleDX", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"s1", ",", "dx"}], "]"}], "\[Rule]", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"s2", ",", "dx"}], "]"}], "\[Rule]", "C"}], ",", " ", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"c1", ",", "dx"}], "]"}], "\[Rule]", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"c2", ",", "dx"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"-", "C"}], " ", 
       RowBox[{"s2", "/", "c2"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"tgl", ",", "dx"}], "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"dy2dx", ",", "dx"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"C", "/", 
        RowBox[{"(", 
         RowBox[{"c1", "+", "c2"}], ")"}]}], 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{
          RowBox[{"s2", "/", "c2"}], " ", "dy2dx"}]}], ")"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"Dt", "[", 
       RowBox[{"C", ",", "dx"}], "]"}], "\[Rule]", "0"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766810424969243*^9, 3.76681053588979*^9}, {
   3.7668106194812717`*^9, 3.766810625909935*^9}, {3.766810968124752*^9, 
   3.766810984070957*^9}, {3.76681114722619*^9, 3.766811162265703*^9}, {
   3.7668112240492287`*^9, 3.766811264976507*^9}, {3.766811340615672*^9, 
   3.7668113494887733`*^9}, {3.76681208560498*^9, 3.766812094090744*^9}, {
   3.767698514788108*^9, 3.767698515616152*^9}, 3.767700267714959*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1 st derivatives of position over small step dx :", "Subtitle",
 CellChangeTimes->{{3.766812618154068*^9, 3.766812654415432*^9}},
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dYdX1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dy", ",", "dx"}], "]"}], " ", "/.", " ", "RuleDX"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766810358440151*^9, 3.7668103635881557`*^9}, 
   3.766810410121962*^9, {3.766810448728179*^9, 3.766810460694343*^9}, {
   3.7668117018050013`*^9, 3.766811714028701*^9}, 3.766812408861807*^9, 
   3.7668125142548027`*^9},
 FontColor->GrayLevel[0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dZdX1", " ", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dz", ",", "dx"}], "]"}], " ", "/.", " ", "RuleDX"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.766811319592885*^9, 3.766811330902913*^9}, {
   3.766811717494177*^9, 3.766811722411425*^9}, 3.76681241276219*^9, 
   3.766812517720705*^9},
 FontColor->GrayLevel[0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RuleLim0", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dx", "\[Rule]", "0"}], ",", 
     RowBox[{"s2", "\[Rule]", "s1"}], ",", " ", 
     RowBox[{"c2", "\[Rule]", "c1"}], ",", " ", 
     RowBox[{
      RowBox[{"s1", "/", "c1"}], "\[Rule]", "stc"}], ",", " ", 
     RowBox[{"dy2dx", "\[Rule]", "stc"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7668115593031197`*^9, 3.76681169406382*^9}, {
  3.766811782337994*^9, 3.766811809607565*^9}, {3.766812696171336*^9, 
  3.766812702169314*^9}},
 FontColor->GrayLevel[0]],

Cell[CellGroupData[{

Cell["1 st derivatives value at dx -> 0", "Subsubtitle",
 CellChangeTimes->{{3.766812762126689*^9, 3.766812789323349*^9}},
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dYdX1L", " ", "=", " ", 
  RowBox[{"dYdX1", " ", "//.", " ", "RuleLim0"}]}]], "Input",
 CellChangeTimes->{{3.766811733733066*^9, 3.7668117451541567`*^9}, 
   3.766811850282989*^9, {3.766812251205974*^9, 3.766812251293537*^9}, {
   3.7668123919338818`*^9, 3.766812416951215*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData["stc"], "Output",
 CellChangeTimes->{
  3.76681174692848*^9, 3.766811819433317*^9, 3.766811850869713*^9, 
   3.766812253809527*^9, 3.766812455597316*^9, 3.766812535915291*^9, {
   3.7673554580356483`*^9, 3.7673554815197144`*^9}, 3.767355589189534*^9, 
   3.767529915738388*^9, 3.767697864835981*^9, 3.767698534289817*^9, 
   3.767699769250064*^9, 3.767700328446068*^9, 3.7677033065908737`*^9, 
   3.767941938948642*^9, 3.7679468933103533`*^9, 3.7679469838562307`*^9, 
   3.767948462695372*^9, 3.767960870258382*^9, 3.76796094237716*^9, 
   3.767960978773924*^9, 3.767962167087344*^9, 3.767962438445546*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dZdX1L", " ", "=", " ", 
  RowBox[{"dZdX1", " ", "//.", " ", "RuleLim0"}]}]], "Input",
 CellChangeTimes->{{3.766811828497398*^9, 3.766811844674095*^9}, {
  3.766812256154632*^9, 3.766812257206461*^9}, {3.7668123966284857`*^9, 
  3.766812420229146*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"c1", "+", 
    RowBox[{"s1", " ", "stc"}]}], ")"}], " ", "tgl"}]], "Output",
 CellChangeTimes->{
  3.766811846133223*^9, 3.7668119470993347`*^9, 3.7668122577289133`*^9, 
   3.766812400771947*^9, 3.766812455886704*^9, 3.766812536100391*^9, {
   3.7673554584651613`*^9, 3.767355482452355*^9}, 3.767355590809354*^9, 
   3.7675299161422243`*^9, 3.76769786598419*^9, 3.767698534868202*^9, 
   3.767699770169629*^9, 3.767700330836729*^9, 3.767703307012107*^9, 
   3.767941939178059*^9, 3.7679468960798388`*^9, 3.767946983875991*^9, 
   3.767948463118987*^9, 3.767960870350094*^9, 3.767960942829932*^9, 
   3.767960979128118*^9, 3.767962167316526*^9, 3.767962439241949*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2nd derivatives of position over small step dx :", "Subtitle",
 CellChangeTimes->{{3.766812618154068*^9, 3.7668126742933292`*^9}},
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dYdX2", " ", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dYdX1", ",", "dx"}], "]"}], " ", "//.", " ", "RuleDX"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.76681204117323*^9, 3.766812073487114*^9}, {
   3.766812104080225*^9, 3.7668121114246683`*^9}, {3.7668123239131937`*^9, 
   3.766812334564074*^9}, 3.766812427247098*^9, 3.76681252460861*^9},
 FontColor->GrayLevel[0]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dZdX2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dZdX1", ",", "dx"}], "]"}], " ", "//.", " ", "RuleDX"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.76681214110918*^9, 3.766812141492297*^9}, {
   3.766812291138812*^9, 3.7668123192227917`*^9}, 3.766812424541368*^9, 
   3.7668125263932247`*^9, 3.76769974047789*^9, 3.7677003496553392`*^9},
 FontColor->GrayLevel[0]],

Cell[CellGroupData[{

Cell["2nd derivatives value at dx -> 0", "Subsubtitle",
 CellChangeTimes->{{3.766812762126689*^9, 3.766812806430334*^9}, {
  3.766812895275343*^9, 3.76681289539117*^9}},
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dYdX2L", " ", "=", " ", 
  RowBox[{"dYdX2", " ", "//.", " ", "RuleLim0"}]}]], "Input",
 CellChangeTimes->{{3.7668122694862947`*^9, 3.766812271857666*^9}, {
  3.7668124310352983`*^9, 3.766812433375082*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 FractionBox[
  RowBox[{"C", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["stc", "2"]}], ")"}]}], "c1"]], "Output",
 CellChangeTimes->{
  3.766812348219008*^9, 3.7668124562132683`*^9, 3.766812536489053*^9, {
   3.7673554602604933`*^9, 3.767355483594735*^9}, 3.767355593055341*^9, 
   3.7675299170449343`*^9, 3.767697869285666*^9, 3.7676985367407312`*^9, 
   3.7676997716361847`*^9, 3.767700335602811*^9, 3.767703308801099*^9, 
   3.767941941320436*^9, 3.767946899846335*^9, 3.7679469840797787`*^9, 
   3.767948464008566*^9, 3.7679608708387613`*^9, 3.767960944315166*^9, 
   3.7679609798374653`*^9, 3.7679621679095163`*^9, 3.767962440251472*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dZdX2L", " ", "=", " ", 
  RowBox[{"dZdX2", " ", "//.", " ", "RuleLim0"}]}]], "Input",
 CellChangeTimes->{{3.76681244381809*^9, 3.766812447178628*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{"C", " ", "stc", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    SuperscriptBox["stc", "2"]}], ")"}], " ", "tgl"}]], "Output",
 CellChangeTimes->{
  3.7668124564899597`*^9, 3.7668125367764587`*^9, {3.767355460648912*^9, 
   3.767355484028639*^9}, 3.7673555943338223`*^9, 3.767529917488873*^9, 
   3.767697870306033*^9, 3.767698537312788*^9, 3.767699772644342*^9, 
   3.767700339775815*^9, 3.767703309275279*^9, 3.7679419415823393`*^9, 
   3.7679469013236713`*^9, 3.7679469841981783`*^9, 3.76794846443598*^9, 
   3.7679608709993563`*^9, 3.767960945175559*^9, 3.767960980256617*^9, 
   3.767962168185017*^9, 3.767962440701948*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["3d derivatives of position over small step dx :", "Subtitle",
 CellChangeTimes->{{3.766812618154068*^9, 3.7668126742933292`*^9}, {
  3.766812823684044*^9, 3.766812824195549*^9}},
 FontColor->RGBColor[0.6, 0.4, 0.2]],

Cell[BoxData[
 RowBox[{
  RowBox[{"dYdX3", " ", "=", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dYdX2", ",", "dx"}], "]"}], " ", "//.", " ", "RuleDX"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.76681204117323*^9, 3.766812073487114*^9}, {
   3.766812104080225*^9, 3.7668121114246683`*^9}, {3.7668123239131937`*^9, 
   3.766812334564074*^9}, 3.766812427247098*^9, 3.76681252460861*^9, {
   3.766812833665797*^9, 3.7668128804208813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dZdX3", " ", "=", " ", 
   RowBox[{
    RowBox[{"Dt", "[", 
     RowBox[{"dZdX2", ",", "dx"}], "]"}], " ", "//.", " ", "RuleDX"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.76681214110918*^9, 3.766812141492297*^9}, {
   3.766812291138812*^9, 3.7668123192227917`*^9}, 3.766812424541368*^9, 
   3.7668125263932247`*^9, {3.766812840718741*^9, 3.766812881782817*^9}}],

Cell[CellGroupData[{

Cell["3d derivatives value at dx -> 0", "Subsubtitle",
 CellChangeTimes->{{3.766812762126689*^9, 3.766812806430334*^9}, {
  3.766812891039959*^9, 3.766812892828253*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dYdX3L", " ", "=", " ", 
  RowBox[{"dYdX3", " ", "//.", " ", "RuleLim0"}]}]], "Input",
 CellChangeTimes->{{3.7668122694862947`*^9, 3.766812271857666*^9}, {
  3.7668124310352983`*^9, 3.766812433375082*^9}, {3.76681289928619*^9, 
  3.766812901800346*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", 
    SuperscriptBox["C", "2"], " ", "s1", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["stc", "2"]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["c1", "3"]}]], "+", 
  FractionBox[
   RowBox[{"3", " ", "C", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"C", " ", "stc"}], "c1"], "+", 
      FractionBox[
       RowBox[{"C", " ", 
        SuperscriptBox["s1", "2"], " ", "stc"}], 
       SuperscriptBox["c1", "3"]], "+", 
      FractionBox[
       RowBox[{"C", " ", "s1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["stc", "2"]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["c1", "2"]}]]}], ")"}]}], 
   RowBox[{"2", " ", "c1"}]]}]], "Output",
 CellChangeTimes->{
  3.766812348219008*^9, 3.7668124562132683`*^9, 3.766812536489053*^9, 
   3.766812902930932*^9, {3.7673554623927402`*^9, 3.7673554858670883`*^9}, 
   3.767355597625078*^9, 3.767529918079359*^9, 3.767697871348051*^9, 
   3.767698539255519*^9, 3.767699774313177*^9, 3.767700343902966*^9, 
   3.7677033099583263`*^9, 3.767941943794882*^9, 3.767946902329341*^9, 
   3.7679469843903522`*^9, 3.767948465343977*^9, 3.767960871397704*^9, 
   3.767960946358959*^9, 3.767960981069154*^9, 3.767962168667451*^9, 
   3.767962441742887*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dZdX3L", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"dZdX3", " ", "//.", " ", "RuleLim0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.76681244381809*^9, 3.766812447178628*^9}, {
  3.766812905942499*^9, 3.766812908638542*^9}, {3.767701051627124*^9, 
  3.7677010581392384`*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["C", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"6", " ", 
      SuperscriptBox["c1", "2"], " ", 
      SuperscriptBox["stc", "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox["s1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["stc", "2"]}], ")"}]}], "+", 
     RowBox[{"c1", " ", "s1", " ", "stc", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["stc", "2"]}], ")"}]}]}], ")"}], " ", "tgl"}], 
  RowBox[{"4", " ", 
   SuperscriptBox["c1", "3"]}]]], "Output",
 CellChangeTimes->{
  3.7668124564899597`*^9, 3.7668125367764587`*^9, 3.7668129091651278`*^9, {
   3.767355462798308*^9, 3.7673554864244633`*^9}, 3.767355597647663*^9, 
   3.767529918551114*^9, 3.767697872442718*^9, 3.767698539780945*^9, 
   3.7676997748259974`*^9, 3.7677003439220963`*^9, 3.7677010589585543`*^9, 
   3.767703310463553*^9, 3.767941944137895*^9, 3.7679469029158373`*^9, 
   3.7679469847894917`*^9, 3.767948465838293*^9, 3.767960871567585*^9, 
   3.767960946842972*^9, 3.767960981522231*^9, 3.767962168859078*^9, 
   3.7679624423768463`*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"dZdX3L", "/", "dZdX2L"}], " ", "//.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"stc", "\[Rule]", 
       RowBox[{"s1", "/", "c1"}]}], ",", 
      RowBox[{"s1", "\[Rule]", 
       RowBox[{"Sin", "[", "a", "]"}]}], ",", " ", 
      RowBox[{"c1", "\[Rule]", 
       RowBox[{"Cos", "[", "a", "]"}]}]}], "}"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.767529923051777*^9, 3.767529967344788*^9}, {
  3.767529998487444*^9, 3.767530005288782*^9}, {3.7675300518141527`*^9, 
  3.767530134990789*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 RowBox[{"3", " ", "C", " ", 
  RowBox[{"Sec", "[", "a", "]"}], " ", 
  RowBox[{"Tan", "[", "a", "]"}]}]], "Output",
 CellChangeTimes->{
  3.767529950608797*^9, 3.767530006118826*^9, {3.767530072536632*^9, 
   3.7675301370705757`*^9}, 3.767697874043969*^9, 3.767698540971908*^9, 
   3.7676997758339777`*^9, 3.7677003445867968`*^9, 3.76770331155479*^9, 
   3.76794194541527*^9, 3.767946903769856*^9, 3.767946984952814*^9, 
   3.7679484666251793`*^9, 3.767960871712874*^9, 3.7679609472700653`*^9, 
   3.76796098187532*^9, 3.767962169047183*^9, 3.767962443175523*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"dZdX3L", " ", "//.", " ", 
   RowBox[{"stc", "\[Rule]", 
    RowBox[{"s1", "/", "c1"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767530338433482*^9, 3.767530340297511*^9}, {
  3.767530502464747*^9, 3.767530514426763*^9}},
 FontColor->RGBColor[0, 0, 1]],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["C", "2"], " ", 
   SuperscriptBox["s1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["c1", "2"], "+", 
     SuperscriptBox["s1", "2"]}], ")"}], " ", "tgl"}], 
  SuperscriptBox["c1", "5"]]], "Output",
 CellChangeTimes->{3.7675303420070343`*^9, 3.767530515205667*^9, 
  3.7676978751640577`*^9, 3.767698541650388*^9, 3.7676997762334146`*^9, 
  3.7677003460534897`*^9, 3.767703311965001*^9, 3.767941946608783*^9, 
  3.767946904244475*^9, 3.767946985084037*^9, 3.767948467012457*^9, 
  3.767960871788274*^9, 3.7679609479535*^9, 3.7679609825726557`*^9, 
  3.7679621692843533`*^9, 3.767962443818017*^9},
 FontColor->RGBColor[0, 0, 1]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["CHECK", "Subsubtitle",
 CellChangeTimes->{{3.767698826935831*^9, 3.76769883935577*^9}},
 Background->RGBColor[1, 0.85, 0.85]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dyn", " ", "=", " ", 
  RowBox[{"dy", " ", "//.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s1", "\[Rule]", "S1"}], ",", " ", 
     RowBox[{"c1", "\[Rule]", "C1"}], ",", " ", 
     RowBox[{"s2", "\[Rule]", "S2"}], ",", " ", 
     RowBox[{"c2", "\[Rule]", "C2"}], ",", " ", 
     RowBox[{"dy2dx", "->", "DY2DX"}], ",", " ", 
     RowBox[{"dx", "\[Rule]", "DX"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"dzn", " ", "=", " ", 
  RowBox[{"dz", " ", "//.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s1", "\[Rule]", "S1"}], ",", " ", 
     RowBox[{"c1", "\[Rule]", "C1"}], ",", " ", 
     RowBox[{"s2", "\[Rule]", "S2"}], ",", " ", 
     RowBox[{"c2", "\[Rule]", "C2"}], ",", " ", 
     RowBox[{"dy2dx", "->", "DY2DX"}], ",", " ", 
     RowBox[{"dx", "\[Rule]", "DX"}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.767697762814577*^9, 3.767697781350588*^9}, {
   3.767697823506641*^9, 3.767697906621307*^9}, 3.7676979655142593`*^9, {
   3.767698019982575*^9, 3.767698032640916*^9}, {3.7676980943484497`*^9, 
   3.767698103241097*^9}, {3.7676988602477217`*^9, 3.7676988824663477`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"DX", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"C", " ", "DX"}], "+", 
     RowBox[{"2", " ", "S1"}]}], ")"}]}], 
  RowBox[{
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}]], "+", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.7676978587354097`*^9, 3.7676978760515013`*^9}, 
   3.767697926307035*^9, 3.7676979668977327`*^9, {3.767698034532428*^9, 
   3.7676980394033527`*^9}, 3.7676981039173803`*^9, 3.767698543545121*^9, 
   3.7676988716352663`*^9, 3.767699776691292*^9, 3.767700346888699*^9, 
   3.767703312457258*^9, 3.767941946882662*^9, 3.767946904663713*^9, 
   3.767946985113406*^9, 3.767948467404832*^9, 3.767960871802989*^9, 
   3.76796094797127*^9, 3.767960982909472*^9, 3.767962169507163*^9, 
   3.76796244496124*^9}],

Cell[BoxData[
 RowBox[{"DX", " ", 
  RowBox[{"(", 
   RowBox[{
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"C", " ", "DX"}], "+", 
        RowBox[{"2", " ", "S1"}]}], ")"}]}], 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["S1", "2"]}]], "+", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"C", " ", "DX"}], "+", "S1"}], ")"}], "2"]}]]}]]}], ")"}], 
  " ", "tgl"}]], "Output",
 CellChangeTimes->{{3.7676978587354097`*^9, 3.7676978760515013`*^9}, 
   3.767697926307035*^9, 3.7676979668977327`*^9, {3.767698034532428*^9, 
   3.7676980394033527`*^9}, 3.7676981039173803`*^9, 3.767698543545121*^9, 
   3.7676988716352663`*^9, 3.767699776691292*^9, 3.767700346888699*^9, 
   3.767703312457258*^9, 3.767941946882662*^9, 3.767946904663713*^9, 
   3.767946985113406*^9, 3.767948467404832*^9, 3.767960871802989*^9, 
   3.76796094797127*^9, 3.767960982909472*^9, 3.767962169507163*^9, 
   3.767962444971774*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"dyn", ",", "DX"}], "]"}], " ", "//.", " ", 
    RowBox[{"DX", "\[Rule]", "0"}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.767698064600869*^9, 3.767698081374075*^9}, {
  3.767698119266445*^9, 3.767698123345214*^9}, {3.767698956328491*^9, 
  3.767699035491941*^9}, {3.767699083943816*^9, 3.767699086460472*^9}, {
  3.767703089017529*^9, 3.767703176315467*^9}}],

Cell[BoxData[
 FractionBox["S1", 
  SqrtBox[
   RowBox[{"1", "-", 
    SuperscriptBox["S1", "2"]}]]]], "Output",
 CellChangeTimes->{{3.7676981138497953`*^9, 3.767698125781831*^9}, 
   3.7676985468212347`*^9, 3.767698966329735*^9, {3.767698997467309*^9, 
   3.7676990362605667`*^9}, 3.767699087100932*^9, 3.7676997767174063`*^9, 
   3.767700347984208*^9, 3.767703168481522*^9, 3.767703312488031*^9, 
   3.7679419472086*^9, 3.767946905119492*^9, 3.767946985299459*^9, 
   3.767948467773081*^9, 3.7679608719241123`*^9, 3.767960948398149*^9, 
   3.7679609836871653`*^9, 3.76796216997827*^9, 3.767962446722144*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dyn", ",", 
     RowBox[{"{", 
      RowBox[{"DX", ",", "2"}], "}"}]}], "]"}], " ", "//.", " ", 
   RowBox[{"DX", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767698133561708*^9, 3.767698157290779*^9}, {
   3.767698893129548*^9, 3.7676989314904547`*^9}, {3.767699040136166*^9, 
   3.767699073870829*^9}, 3.767703178244514*^9, 3.767703214142514*^9}],

Cell[BoxData[
 FractionBox["C", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{{3.767698148294868*^9, 3.7676981587746162`*^9}, 
   3.7676985476495256`*^9, 3.767698899226404*^9, {3.7676989327472067`*^9, 
   3.767698951101842*^9}, {3.767699053188525*^9, 3.7676990791115007`*^9}, 
   3.767699777223042*^9, 3.767700350160665*^9, 3.7677031824058523`*^9, 
   3.7677033129362392`*^9, 3.767941947443721*^9, 3.767946908192477*^9, 
   3.767946985436277*^9, 3.767948468110991*^9, 3.767960872011489*^9, 
   3.7679609490764914`*^9, 3.7679609839706173`*^9, 3.76796217017047*^9, 
   3.767962447282123*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dzn", ",", "DX"}], "]"}], " ", "//.", " ", 
   RowBox[{"DX", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767698064600869*^9, 3.767698081374075*^9}, {
  3.767698119266445*^9, 3.767698123345214*^9}, {3.767698956328491*^9, 
  3.767699035491941*^9}, {3.767699083943816*^9, 3.7676990980580063`*^9}, {
  3.767703218046443*^9, 3.767703234720132*^9}}],

Cell[BoxData[
 FractionBox["tgl", 
  SqrtBox[
   RowBox[{"1", "-", 
    SuperscriptBox["S1", "2"]}]]]], "Output",
 CellChangeTimes->{3.767699098600602*^9, 3.7676997782464037`*^9, 
  3.76770035114885*^9, 3.7677032213424788`*^9, 3.76770331395362*^9, 
  3.767941947683401*^9, 3.767946909021346*^9, 3.767946985564032*^9, 
  3.767948468894219*^9, 3.767960872107626*^9, 3.767960949451653*^9, 
  3.7679609844116793`*^9, 3.7679621703594933`*^9, 3.767962447916047*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dzn", ",", 
     RowBox[{"{", 
      RowBox[{"DX", ",", "2"}], "}"}]}], "]"}], " ", "//.", " ", 
   RowBox[{"DX", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767698064600869*^9, 3.767698081374075*^9}, {
  3.767698119266445*^9, 3.767698123345214*^9}, {3.767698956328491*^9, 
  3.767699035491941*^9}, {3.767699083943816*^9, 3.767699116496028*^9}, {
  3.7677032384992647`*^9, 3.767703252283909*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"C", " ", "S1", " ", "tgl"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}], ")"}], 
   RowBox[{"3", "/", "2"}]]]], "Output",
 CellChangeTimes->{3.767699117636656*^9, 3.767699779283237*^9, 
  3.767700351857834*^9, 3.767703242927855*^9, 3.767703314353347*^9, 
  3.767941948780581*^9, 3.76794690959557*^9, 3.767946985867098*^9, 
  3.767948469264616*^9, 3.7679608722097263`*^9, 3.767960949829226*^9, 
  3.767960984820383*^9, 3.767962170553342*^9, 3.767962448587365*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dyn", ",", 
     RowBox[{"{", 
      RowBox[{"DX", ",", "3"}], "}"}]}], "]"}], " ", "//.", " ", 
   RowBox[{"DX", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7677008942242928`*^9, 3.767700894440243*^9}, 
   3.7677032541853027`*^9, 3.767703285694788*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["C", "2"], " ", "S1"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}], ")"}], 
   RowBox[{"5", "/", "2"}]]]], "Output",
 CellChangeTimes->{3.76770090100377*^9, 3.767703255834502*^9, 
  3.767703314816318*^9, 3.7679419491082153`*^9, 3.767946910113988*^9, 
  3.767946985987602*^9, 3.767948469709519*^9, 3.767960872443287*^9, 
  3.7679609498453703`*^9, 3.767960985214232*^9, 3.767962170833899*^9, 
  3.767962449107769*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"dzn", ",", 
     RowBox[{"{", 
      RowBox[{"DX", ",", "3"}], "}"}]}], "]"}], " ", "//.", " ", 
   RowBox[{"DX", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.767700912098584*^9, 3.7677009125926332`*^9}, {
  3.767703288639657*^9, 3.767703296320281*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"3", " ", 
   SuperscriptBox["C", "2"], " ", 
   SuperscriptBox["S1", "2"], " ", "tgl"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["S1", "2"]}], ")"}], 
   RowBox[{"5", "/", "2"}]]]], "Output",
 CellChangeTimes->{
  3.7677009136849327`*^9, {3.767703289892864*^9, 3.7677033151911087`*^9}, 
   3.767941949352046*^9, 3.7679469104926453`*^9, 3.767946986121663*^9, 
   3.767948470077311*^9, 3.767960872636397*^9, 3.7679609502172537`*^9, 
   3.767960985738791*^9, 3.767962171041689*^9, 3.767962449802065*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2201, 1872},
WindowMargins->{{Automatic, 44}, {Automatic, 37}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 146, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[728, 26, 609, 10, 189, "Section"],
Cell[1340, 38, 1176, 35, 32, "Input"],
Cell[2519, 75, 686, 14, 48, "Input"],
Cell[CellGroupData[{
Cell[3230, 93, 337, 6, 45, "Subsection"],
Cell[3570, 101, 769, 19, 143, "Input"],
Cell[4342, 122, 572, 13, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4951, 140, 371, 6, 45, "Subsection"],
Cell[5325, 148, 1114, 29, 143, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6488, 183, 448, 8, 117, "Section"],
Cell[6939, 193, 767, 21, 77, "Input"],
Cell[CellGroupData[{
Cell[7731, 218, 330, 6, 45, "Subsection"],
Cell[8064, 226, 519, 14, 32, "Input"],
Cell[8586, 242, 142, 4, 32, "Input"],
Cell[8731, 248, 2480, 69, 77, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11248, 322, 384, 5, 45, "Subsection"],
Cell[CellGroupData[{
Cell[11657, 331, 632, 11, 32, "Input"],
Cell[12292, 344, 4122, 118, 121, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16451, 467, 220, 4, 32, "Input"],
Cell[16674, 473, 2551, 70, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19262, 548, 220, 4, 32, "Input"],
Cell[19485, 554, 1990, 50, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21512, 609, 246, 5, 32, "Input"],
Cell[21761, 616, 2522, 64, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24320, 685, 534, 9, 83, "Subsubsection"],
Cell[24857, 696, 1051, 29, 35, "Input"],
Cell[25911, 727, 384, 7, 32, "Input"],
Cell[26298, 736, 701, 16, 77, "Input"],
Cell[27002, 754, 140, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[27167, 759, 641, 14, 48, "Input"],
Cell[27811, 775, 531, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28379, 790, 485, 12, 48, "Input"],
Cell[28867, 804, 559, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29463, 819, 484, 12, 48, "Input"],
Cell[29950, 833, 560, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30547, 848, 487, 12, 48, "Input"],
Cell[31037, 862, 532, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31606, 877, 489, 12, 48, "Input"],
Cell[32098, 891, 554, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32689, 906, 535, 13, 48, "Input"],
Cell[33227, 921, 554, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33818, 936, 685, 15, 48, "Input"],
Cell[34506, 953, 528, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35071, 968, 537, 13, 48, "Input"],
Cell[35611, 983, 559, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36207, 998, 533, 13, 48, "Input"],
Cell[36743, 1013, 557, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37337, 1028, 539, 13, 48, "Input"],
Cell[37879, 1043, 527, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38443, 1058, 539, 13, 48, "Input"],
Cell[38985, 1073, 568, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39590, 1088, 583, 14, 48, "Input"],
Cell[40176, 1104, 558, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40771, 1119, 709, 15, 48, "Input"],
Cell[41483, 1136, 533, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42053, 1151, 537, 13, 48, "Input"],
Cell[42593, 1166, 557, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43187, 1181, 529, 13, 48, "Input"],
Cell[43719, 1196, 560, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44316, 1211, 534, 13, 48, "Input"],
Cell[44853, 1226, 527, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45417, 1241, 536, 13, 48, "Input"],
Cell[45956, 1256, 562, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46555, 1271, 585, 14, 48, "Input"],
Cell[47143, 1287, 562, 10, 62, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47778, 1305, 390, 6, 81, "Section"],
Cell[48171, 1313, 3661, 105, 445, "Input"],
Cell[51835, 1420, 1348, 31, 77, "Input"],
Cell[CellGroupData[{
Cell[53208, 1455, 136, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[53369, 1460, 7511, 229, 957, "Input"],
Cell[60883, 1691, 651, 21, 32, "Output"],
Cell[61537, 1714, 550, 11, 24, "Message"],
Cell[62090, 1727, 548, 11, 24, "Message"],
Cell[62641, 1740, 550, 11, 24, "Message"],
Cell[63194, 1753, 548, 11, 24, "Message"]
}, Open  ]],
Cell[63757, 1767, 2119, 62, 275, "Input"],
Cell[65879, 1831, 4498, 124, 583, "Input"],
Cell[CellGroupData[{
Cell[70402, 1959, 3575, 66, 957, "Input"],
Cell[73980, 2027, 17752, 534, 297, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[91781, 2567, 139, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[91945, 2573, 741, 13, 77, "Input"],
Cell[92689, 2588, 1428, 34, 47, "Output"],
Cell[94120, 2624, 1431, 34, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95588, 2663, 169, 3, 32, "Input"],
Cell[95760, 2668, 453, 8, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96250, 2681, 170, 3, 32, "Input"],
Cell[96423, 2686, 460, 8, 46, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[96932, 2700, 212, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[97169, 2709, 632, 13, 77, "Input"],
Cell[97804, 2724, 2128, 48, 84, "Output"],
Cell[99935, 2774, 2129, 48, 84, "Output"],
Cell[102067, 2824, 2211, 44, 121, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104315, 2873, 174, 3, 32, "Input"],
Cell[104492, 2878, 647, 10, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105176, 2893, 172, 3, 32, "Input"],
Cell[105351, 2898, 644, 10, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106032, 2913, 174, 3, 32, "Input"],
Cell[106209, 2918, 691, 11, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106937, 2934, 161, 3, 32, "Input"],
Cell[107101, 2939, 3249, 57, 334, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[110411, 3003, 517, 9, 117, "Section"],
Cell[CellGroupData[{
Cell[110953, 3016, 155, 2, 45, "Subsection"],
Cell[111111, 3020, 426, 12, 55, "Input"],
Cell[111540, 3034, 1107, 30, 143, "Input"],
Cell[CellGroupData[{
Cell[112672, 3068, 597, 13, 48, "Input"],
Cell[113272, 3083, 848, 24, 77, "Output"],
Cell[114123, 3109, 820, 23, 77, "Output"],
Cell[114946, 3134, 798, 23, 77, "Output"],
Cell[115747, 3159, 776, 23, 77, "Output"],
Cell[116526, 3184, 750, 22, 77, "Output"],
Cell[117279, 3208, 728, 22, 77, "Output"],
Cell[118010, 3232, 704, 22, 77, "Output"],
Cell[118717, 3256, 678, 21, 77, "Output"],
Cell[119398, 3279, 656, 21, 77, "Output"],
Cell[120057, 3302, 634, 21, 77, "Output"],
Cell[120694, 3325, 609, 20, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121340, 3350, 249, 6, 48, "Input"],
Cell[121592, 3358, 831, 22, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122460, 3385, 622, 16, 48, "Input"],
Cell[123085, 3403, 522, 12, 69, "Output"]
}, Open  ]],
Cell[123622, 3418, 1625, 43, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125296, 3467, 172, 2, 51, "Subtitle"],
Cell[125471, 3471, 451, 11, 32, "Input"],
Cell[125925, 3484, 367, 10, 32, "Input"],
Cell[126295, 3496, 571, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[126891, 3514, 159, 2, 31, "Subsubtitle"],
Cell[CellGroupData[{
Cell[127075, 3520, 333, 6, 32, "Input"],
Cell[127411, 3528, 650, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128098, 3543, 307, 6, 32, "Input"],
Cell[128408, 3551, 749, 14, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129218, 3572, 173, 2, 51, "Subtitle"],
Cell[129394, 3576, 420, 10, 32, "Input"],
Cell[129817, 3588, 425, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[130267, 3602, 206, 3, 31, "Subsubtitle"],
Cell[CellGroupData[{
Cell[130498, 3609, 260, 5, 32, "Input"],
Cell[130761, 3616, 710, 14, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131508, 3635, 206, 4, 32, "Input"],
Cell[131717, 3641, 682, 13, 34, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[132460, 3661, 221, 3, 51, "Subtitle"],
Cell[132684, 3666, 446, 10, 32, "Input"],
Cell[133133, 3678, 400, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[133558, 3691, 200, 3, 31, "Subsubtitle"],
Cell[CellGroupData[{
Cell[133783, 3698, 308, 6, 32, "Input"],
Cell[134094, 3706, 1391, 37, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135522, 3748, 346, 7, 32, "Input"],
Cell[135871, 3757, 1222, 30, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137130, 3792, 620, 16, 32, "Input"],
Cell[137753, 3810, 609, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138399, 3826, 310, 7, 32, "Input"],
Cell[138712, 3835, 712, 16, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[139473, 3857, 131, 2, 47, "Subsubtitle"],
Cell[CellGroupData[{
Cell[139629, 3863, 1127, 24, 55, "Input"],
Cell[140759, 3889, 939, 24, 60, "Output"],
Cell[141701, 3915, 1315, 37, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143053, 3957, 469, 10, 32, "Input"],
Cell[143525, 3969, 609, 11, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144171, 3985, 453, 10, 32, "Input"],
Cell[144627, 3997, 704, 14, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145368, 4016, 449, 9, 32, "Input"],
Cell[145820, 4027, 459, 9, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146316, 4041, 502, 11, 32, "Input"],
Cell[146821, 4054, 550, 12, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147408, 4071, 359, 9, 32, "Input"],
Cell[147770, 4082, 531, 13, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148338, 4100, 358, 9, 32, "Input"],
Cell[148699, 4111, 578, 14, 59, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
